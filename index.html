<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TSE RP BROOKASIL - Sistema Eleitoral Oficial</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=JetBrains+Mono:wght@300;400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --obsidian: #0a0a0a;
            --gold: #ffd700;
            --gold-light: #fff0a3;
            --gold-dark: #b8860b;
            --cyber-blue: #00f3ff;
            --cyber-pink: #ff00ff;
            --glass-dark: rgba(10, 10, 10, 0.95);
            --glass-light: rgba(255, 215, 0, 0.05);
            --danger: #ff3860;
            --success: #23d160;
            --warning: #ffdd57;
            --purple: #9d4edd;
            --teal: #00ffc3;
            --direita-blue: #0B3C5D;
            --centro-gold: #FFD700;
            --esquerda-red: #CC0000;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'JetBrains Mono', monospace;
            background: var(--obsidian);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 10% 20%, rgba(11, 60, 93, 0.05) 0%, transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(255, 215, 0, 0.05) 0%, transparent 40%),
                radial-gradient(circle at 50% 50%, rgba(204, 0, 0, 0.05) 0%, transparent 50%),
                linear-gradient(45deg, rgba(10, 10, 10, 0.98), rgba(20, 20, 20, 0.99));
            pointer-events: none;
            z-index: -2;
        }

        /* Efeito de grade holográfica */
        .grid-lines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(0, 243, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 243, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: -1;
            animation: gridMove 20s linear infinite;
        }

        @keyframes gridMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }

        /* HEADER INSTITUCIONAL */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: var(--glass-dark);
            backdrop-filter: blur(20px) saturate(200%);
            border-bottom: 1px solid rgba(255, 215, 0, 0.2);
            padding: 1.2rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            box-shadow: 0 5px 30px rgba(0, 0, 0, 0.7);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-icon {
            font-size: 2.5rem;
            color: var(--gold);
            text-shadow: 0 0 15px var(--gold);
        }

        .logo-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            font-weight: 900;
            background: linear-gradient(45deg, var(--gold), var(--teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 1px;
        }

        .logo-subtitle {
            font-size: 0.7rem;
            color: var(--cyber-blue);
            letter-spacing: 3px;
            opacity: 0.8;
            margin-top: 0.2rem;
        }

        .header-info {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .election-mode {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 10px;
            padding: 0.5rem 1rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .mode-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .mode-municipal { background: var(--teal); }
        .mode-federal { background: var(--purple); }

        .mode-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--gold);
        }

        /* SIDEBAR FLUTUANTE */
        .sidebar-container {
            position: fixed;
            left: 2rem;
            top: 50%;
            transform: translateY(-50%);
            z-index: 999;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .sidebar {
            background: var(--glass-dark);
            backdrop-filter: blur(25px) saturate(200%);
            border: 1px solid rgba(255, 215, 0, 0.15);
            border-radius: 20px;
            padding: 1.5rem;
            width: 70px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }

        .sidebar:hover {
            width: 280px;
        }

        .sidebar.hidden {
            transform: translateX(-150%);
        }

        .sidebar-toggle {
            position: absolute;
            right: -15px;
            top: 20px;
            background: var(--glass-dark);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-left: none;
            border-radius: 0 10px 10px 0;
            width: 15px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--gold);
            transition: all 0.3s ease;
        }

        .sidebar-toggle:hover {
            width: 20px;
            background: rgba(255, 215, 0, 0.1);
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            gap: 1.2rem;
            padding: 1rem;
            color: var(--gold-light);
            cursor: pointer;
            border-radius: 12px;
            transition: all 0.3s ease;
            margin-bottom: 0.5rem;
            white-space: nowrap;
            overflow: hidden;
        }

        .sidebar-item:hover {
            background: linear-gradient(90deg, rgba(255, 215, 0, 0.1), transparent);
            color: var(--gold);
            transform: translateX(5px);
        }

        .sidebar-item.active {
            background: linear-gradient(90deg, rgba(255, 215, 0, 0.2), transparent);
            color: var(--gold);
            border-left: 3px solid var(--gold);
        }

        .sidebar-item i {
            font-size: 1.3rem;
            width: 24px;
            text-align: center;
        }

        /* CONTEÚDO PRINCIPAL */
        .main-content {
            margin-top: 100px;
            padding: 2rem;
            max-width: 1600px;
            margin-left: auto;
            margin-right: auto;
            transition: all 0.3s ease;
        }

        .main-content.expanded {
            margin-left: 0;
        }

        .section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* CARD GLASSMORPHISM */
        .card {
            background: var(--glass-dark);
            backdrop-filter: blur(25px) saturate(200%);
            border: 1px solid rgba(255, 215, 0, 0.1);
            border-radius: 24px;
            padding: 3rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.4);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, 
                rgba(255, 215, 0, 0.02) 0%,
                rgba(0, 243, 255, 0.02) 50%,
                rgba(157, 78, 221, 0.02) 100%);
            z-index: -1;
        }

        .card-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            color: var(--gold);
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid rgba(255, 215, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .card-title i {
            font-size: 1.8rem;
        }

        /* STATS GRID */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: linear-gradient(135deg, 
                rgba(255, 215, 0, 0.05), 
                rgba(0, 243, 255, 0.05));
            border: 1px solid rgba(255, 215, 0, 0.1);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--teal);
            box-shadow: 0 10px 30px rgba(0, 243, 255, 0.1);
        }

        .stat-number {
            font-family: 'Orbitron', sans-serif;
            font-size: 3.5rem;
            font-weight: 900;
            background: linear-gradient(45deg, var(--gold), var(--teal));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 1rem 0;
        }

        .stat-label {
            color: var(--cyber-blue);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 600;
        }

        /* FILTROS */
        .filters {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 243, 255, 0.15);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .filter-label {
            color: var(--cyber-blue);
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* FORMULÁRIOS */
        .form-section {
            margin-bottom: 3rem;
            padding: 2rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 16px;
            border: 1px solid rgba(255, 215, 0, 0.1);
        }

        .form-section-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            color: var(--gold);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(255, 215, 0, 0.2);
        }

        .form-group {
            margin-bottom: 1.8rem;
        }

        .form-label {
            display: block;
            color: var(--cyber-blue);
            margin-bottom: 0.8rem;
            font-weight: 600;
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 1.2rem;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 12px;
            color: white;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--teal);
            box-shadow: 0 0 25px rgba(0, 243, 255, 0.2);
        }

        .form-hint {
            color: var(--gold-light);
            font-size: 0.85rem;
            margin-top: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* BOTÕES */
        .btn {
            padding: 1.2rem 2.5rem;
            border: none;
            border-radius: 12px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            font-size: 1rem;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.1), 
                transparent);
            transition: left 0.6s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--gold-dark), var(--gold));
            color: var(--obsidian);
            border: 1px solid var(--gold);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.3);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--gold);
            color: var(--gold);
        }

        .btn-outline:hover {
            background: rgba(255, 215, 0, 0.1);
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.1);
        }

        /* TABELAS */
        .table-container {
            overflow-x: auto;
            margin: 2rem 0;
            border-radius: 16px;
            border: 1px solid rgba(255, 215, 0, 0.1);
        }

        .data-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            background: rgba(0, 0, 0, 0.3);
        }

        .data-table th {
            background: linear-gradient(to bottom, 
                rgba(255, 215, 0, 0.15), 
                rgba(255, 215, 0, 0.1));
            color: var(--gold);
            padding: 1.5rem 1rem;
            text-align: left;
            font-family: 'Orbitron', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.3);
        }

        .data-table td {
            padding: 1.2rem 1rem;
            border-bottom: 1px solid rgba(255, 215, 0, 0.05);
            transition: background 0.3s ease;
        }

        .data-table tr:hover td {
            background: rgba(255, 215, 0, 0.03);
        }

        /* STATUS BADGES */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.6rem 1.2rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .status-pendente {
            background: linear-gradient(45deg, rgba(255, 221, 87, 0.15), transparent);
            color: var(--warning);
            border: 1px solid rgba(255, 221, 87, 0.3);
        }

        .status-aprovado {
            background: linear-gradient(45deg, rgba(35, 209, 96, 0.15), transparent);
            color: var(--success);
            border: 1px solid rgba(35, 209, 96, 0.3);
        }

        .status-rejeitado {
            background: linear-gradient(45deg, rgba(255, 56, 96, 0.15), transparent);
            color: var(--danger);
            border: 1px solid rgba(255, 56, 96, 0.3);
        }

        /* IDEOLOGIA TAGS */
        .ideologia-tag {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .ideologia-direita {
            background: linear-gradient(45deg, rgba(11, 60, 93, 0.2), transparent);
            color: #0B3C5D;
            border: 1px solid rgba(11, 60, 93, 0.3);
        }

        .ideologia-centro {
            background: linear-gradient(45deg, rgba(255, 215, 0, 0.2), transparent);
            color: #FFD700;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .ideologia-esquerda {
            background: linear-gradient(45deg, rgba(204, 0, 0, 0.2), transparent);
            color: #CC0000;
            border: 1px solid rgba(204, 0, 0, 0.3);
        }

        /* PARTIDO CARD */
        .partido-card {
            background: rgba(255, 215, 0, 0.03);
            border: 1px solid rgba(255, 215, 0, 0.1);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .partido-card:hover {
            background: rgba(255, 215, 0, 0.05);
            border-color: rgba(255, 215, 0, 0.3);
            transform: translateX(5px);
        }

        .partido-numero {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            background: linear-gradient(45deg, var(--gold), var(--gold-dark));
            color: var(--obsidian);
            border-radius: 12px;
            font-weight: 900;
            font-size: 1.2rem;
            margin-right: 1rem;
        }

        /* STEPPER FORM */
        .form-stepper {
            display: flex;
            justify-content: space-between;
            margin-bottom: 3rem;
            position: relative;
        }

        .form-stepper::before {
            content: '';
            position: absolute;
            top: 25px;
            left: 0;
            right: 0;
            height: 2px;
            background: rgba(255, 215, 0, 0.2);
            z-index: 1;
        }

        .step {
            position: relative;
            z-index: 2;
            text-align: center;
            flex: 1;
        }

        .step-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255, 215, 0, 0.1);
            border: 2px solid rgba(255, 215, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            color: var(--gold);
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            transition: all 0.3s ease;
        }

        .step.active .step-circle {
            background: var(--gold);
            color: var(--obsidian);
            border-color: var(--gold);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }

        .step.completed .step-circle {
            background: var(--success);
            color: white;
            border-color: var(--success);
        }

        .step-label {
            color: var(--gold-light);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .step.active .step-label {
            color: var(--gold);
            font-weight: 600;
        }

        /* UPLOAD DE FOTO */
        .photo-upload {
            border: 2px dashed rgba(255, 215, 0, 0.3);
            border-radius: 16px;
            padding: 3rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 1.5rem 0;
        }

        .photo-upload:hover {
            border-color: var(--teal);
            background: rgba(0, 243, 255, 0.05);
        }

        .photo-preview {
            max-width: 200px;
            max-height: 200px;
            border-radius: 12px;
            margin: 1rem auto;
            display: none;
        }

        /* MODAL */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.97);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(10px);
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--glass-dark);
            backdrop-filter: blur(30px) saturate(200%);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 24px;
            padding: 3rem;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: modalSlide 0.3s ease;
        }

        @keyframes modalSlide {
            from { transform: translateY(-30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* GRÁFICOS */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .chart-container {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 215, 0, 0.1);
            border-radius: 16px;
            padding: 2rem;
        }

        /* TOOLTIP */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 300px;
            background: var(--glass-dark);
            border: 1px solid rgba(255, 215, 0, 0.3);
            color: var(--gold-light);
            text-align: center;
            border-radius: 12px;
            padding: 1rem;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        /* LOGIN POR CHAVE */
        .login-card {
            background: var(--glass-dark);
            backdrop-filter: blur(30px) saturate(200%);
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 24px;
            padding: 3rem;
            max-width: 500px;
            margin: 2rem auto;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        /* RESPONSIVIDADE */
        @media (max-width: 1200px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                padding: 1rem;
                gap: 1rem;
            }
            
            .header-info {
                flex-direction: column;
                gap: 1rem;
            }
            
            .main-content {
                padding: 1rem;
                margin-top: 140px;
            }
            
            .sidebar-container {
                display: none;
            }
            
            .card {
                padding: 2rem 1.5rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .form-stepper {
                flex-direction: column;
                gap: 2rem;
            }
            
            .form-stepper::before {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .logo-text {
                font-size: 1.4rem;
            }
            
            .card-title {
                font-size: 1.6rem;
            }
            
            .btn {
                padding: 1rem 1.5rem;
            }
        }

        /* ANIMAÇÕES */
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* LOADER */
        .loader {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255, 215, 0, 0.1);
            border-top: 3px solid var(--gold);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 2rem auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* NÚMERO DO CANDIDATO */
        .candidate-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 80px;
            padding: 0.5rem 1rem;
            background: linear-gradient(45deg, var(--gold-dark), var(--gold));
            color: var(--obsidian);
            border-radius: 10px;
            font-family: 'Orbitron', sans-serif;
            font-weight: 900;
            font-size: 1.2rem;
            margin-right: 1rem;
        }

        /* INFO BOX */
        .info-box {
            background: linear-gradient(135deg, 
                rgba(0, 243, 255, 0.05), 
                rgba(157, 78, 221, 0.05));
            border: 1px solid rgba(0, 243, 255, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        /* COUNTER */
        .counter {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            font-weight: 900;
            background: linear-gradient(45deg, var(--teal), var(--purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* MENSAGENS */
        .message {
            padding: 1.5rem;
            border-radius: 12px;
            margin: 1rem 0;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .message-success {
            background: linear-gradient(45deg, rgba(35, 209, 96, 0.1), transparent);
            border: 1px solid rgba(35, 209, 96, 0.3);
            color: var(--success);
        }

        .message-error {
            background: linear-gradient(45deg, rgba(255, 56, 96, 0.1), transparent);
            border: 1px solid rgba(255, 56, 96, 0.3);
            color: var(--danger);
        }

        .message-warning {
            background: linear-gradient(45deg, rgba(255, 221, 87, 0.1), transparent);
            border: 1px solid rgba(255, 221, 87, 0.3);
            color: var(--warning);
        }
    </style>
</head>
<body>
    <!-- Efeitos de fundo -->
    <div class="grid-lines"></div>
    
    <!-- Header -->
    <header class="header">
        <div class="logo-container">
            <div class="logo-icon">
                <i class="fas fa-landmark"></i>
            </div>
            <div>
                <div class="logo-text">TRIBUNAL SUPERIOR ELEITORAL</div>
                <div class="logo-subtitle">REPÚBLICA DE BROOKASIL</div>
            </div>
        </div>
        
        <div class="header-info">
            <div class="election-mode">
                <div class="mode-indicator mode-municipal"></div>
                <div class="mode-text" id="currentElectionMode">ELEIÇÃO MUNICIPAL</div>
            </div>
            
            <div id="adminIndicator" style="display: none;">
                <div class="status-badge status-aprovado">
                    <i class="fas fa-user-shield"></i>
                    MODO ADMINISTRATIVO
                </div>
            </div>
        </div>
    </header>
    
    <!-- Sidebar -->
    <div class="sidebar-container">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-item active" onclick="mostrarSecao('dashboard')">
                <i class="fas fa-chart-bar"></i>
                <span>Dashboard</span>
            </div>
            <div class="sidebar-item" onclick="mostrarSecao('candidatos')">
                <i class="fas fa-users"></i>
                <span>Candidatos</span>
            </div>
            <div class="sidebar-item" onclick="mostrarSecao('candidatura')">
                <i class="fas fa-user-plus"></i>
                <span>Candidatar-se</span>
            </div>
            <div class="sidebar-item" onclick="mostrarSecao('partidos')">
                <i class="fas fa-flag"></i>
                <span>Partidos</span>
            </div>
            <div class="sidebar-item" onclick="mostrarSecao('tres')">
                <i class="fas fa-balance-scale"></i>
                <span>Tribunais Regionais</span>
            </div>
            <div class="sidebar-item" onclick="mostrarSecao('login')" id="loginSidebar">
                <i class="fas fa-key"></i>
                <span>Acesso Administrativo</span>
            </div>
            <div class="sidebar-item" onclick="mostrarSecao('admin')" id="adminSidebar" style="display: none;">
                <i class="fas fa-user-shield"></i>
                <span>Painel Administrativo</span>
            </div>
            <div class="sidebar-item" onclick="mostrarSecao('logs')" id="logsSidebar" style="display: none;">
                <i class="fas fa-history"></i>
                <span>Logs do Sistema</span>
            </div>
            <div class="sidebar-item" onclick="mostrarSecao('config')" id="configSidebar" style="display: none;">
                <i class="fas fa-cog"></i>
                <span>Configurações</span>
            </div>
            <div class="sidebar-item" onclick="toggleSidebar()">
                <i class="fas fa-eye-slash"></i>
                <span>Ocultar Menu</span>
            </div>
        </div>
        <div class="sidebar-toggle" onclick="toggleSidebar()">
            <i class="fas fa-chevron-left"></i>
        </div>
    </div>
    
    <!-- Conteúdo Principal -->
    <main class="main-content" id="mainContent">
        <!-- Dashboard -->
        <section id="dashboard" class="section active">
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-chart-bar"></i>
                    DASHBOARD ELEITORAL - BROOKASIL
                </h2>
                
                <div class="info-box">
                    <h3><i class="fas fa-info-circle"></i> SISTEMA ELEITORAL OFICIAL</h3>
                    <p><strong>Modo da Eleição Atual:</strong> <span id="modoEleicao" class="counter">MUNICIPAL</span></p>
                    <p><strong>Status do Sistema:</strong> <span id="statusSistema" class="status-badge status-aprovado">ATIVO</span></p>
                    <p>Sistema desenvolvido para garantir transparência e segurança no processo eleitoral da República de Brookasil.</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Total de Candidaturas</div>
                        <div class="stat-number" id="totalCandidatos">0</div>
                        <div class="stat-desc">Registradas no sistema</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Candidaturas Aprovadas</div>
                        <div class="stat-number" id="aprovados">0</div>
                        <div class="stat-desc">Homologadas pelos TREs</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Candidaturas Pendentes</div>
                        <div class="stat-number" id="pendentes">0</div>
                        <div class="stat-desc">Aguardando análise</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Candidaturas Rejeitadas</div>
                        <div class="stat-number" id="rejeitados">0</div>
                        <div class="stat-desc">Com motivo registrado</div>
                    </div>
                </div>
                
                <div class="charts-grid">
                    <div class="chart-container">
                        <h3 class="card-title"><i class="fas fa-chart-pie"></i> DISTRIBUIÇÃO POR IDEOLOGIA</h3>
                        <canvas id="ideologiaChart"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <h3 class="card-title"><i class="fas fa-chart-bar"></i> DISTRIBUIÇÃO POR CARGO</h3>
                        <canvas id="cargoChart"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <h3 class="card-title"><i class="fas fa-map"></i> DISTRIBUIÇÃO POR ESTADO</h3>
                        <canvas id="estadoChart"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <h3 class="card-title"><i class="fas fa-flag"></i> TOP 10 PARTIDOS</h3>
                        <canvas id="partidoChart"></canvas>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Candidatos (Público) -->
        <section id="candidatos" class="section">
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-users"></i>
                    CANDIDATOS REGISTRADOS
                </h2>
                
                <div class="filters">
                    <h3><i class="fas fa-filter"></i> FILTROS AVANÇADOS</h3>
                    <div class="filter-grid">
                        <div class="filter-group">
                            <label class="filter-label"><i class="fas fa-map"></i> ESTADO</label>
                            <select class="form-select" id="filterEstado">
                                <option value="">Todos os Estados</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label class="filter-label"><i class="fas fa-city"></i> CIDADE</label>
                            <select class="form-select" id="filterCidade">
                                <option value="">Todas as Cidades</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label class="filter-label"><i class="fas fa-user-tie"></i> CARGO</label>
                            <select class="form-select" id="filterCargo">
                                <option value="">Todos os Cargos</option>
                                <option value="Presidente">Presidente</option>
                                <option value="Governador">Governador</option>
                                <option value="Senador">Senador</option>
                                <option value="Deputado Federal">Deputado Federal</option>
                                <option value="Deputado Estadual">Deputado Estadual</option>
                                <option value="Prefeito">Prefeito</option>
                                <option value="Vereador">Vereador</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label class="filter-label"><i class="fas fa-user-tag"></i> IDEOLOGIA</label>
                            <select class="form-select" id="filterIdeologia">
                                <option value="">Todas as Ideologias</option>
                                <option value="direita">Direita</option>
                                <option value="centro">Centro</option>
                                <option value="esquerda">Esquerda</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label class="filter-label"><i class="fas fa-flag"></i> PARTIDO</label>
                            <select class="form-select" id="filterPartido">
                                <option value="">Todos os Partidos</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label class="filter-label"><i class="fas fa-check-circle"></i> STATUS</label>
                            <select class="form-select" id="filterStatus">
                                <option value="">Todos os Status</option>
                                <option value="PENDENTE">Pendente</option>
                                <option value="APROVADO">Aprovado</option>
                                <option value="REJEITADO">Rejeitado</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                        <button class="btn btn-primary" onclick="filtrarCandidatos()">
                            <i class="fas fa-filter"></i> APLICAR FILTROS
                        </button>
                        <button class="btn btn-outline" onclick="resetarFiltros()">
                            <i class="fas fa-trash"></i> LIMPAR FILTROS
                        </button>
                    </div>
                </div>
                
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>NÚMERO</th>
                                <th>CANDIDATO</th>
                                <th>CARGO</th>
                                <th>PARTIDO</th>
                                <th>LOCALIDADE</th>
                                <th>IDEOLOGIA</th>
                                <th>STATUS</th>
                                <th>AÇÕES</th>
                            </tr>
                        </thead>
                        <tbody id="candidatosTable">
                            <!-- Dados carregados via JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <div id="candidatosMessage" class="message" style="display: none;"></div>
            </div>
        </section>
        
        <!-- Candidatura Pública -->
        <section id="candidatura" class="section">
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-user-plus"></i>
                    FORMULÁRIO DE CANDIDATURA
                </h2>
                
                <div class="info-box">
                    <h3><i class="fas fa-info-circle"></i> INFORMAÇÕES IMPORTANTES</h3>
                    <p>• Todos os dados devem ser FICTÍCIOS - este é um sistema de Roleplay (RP)<br>
                    • Candidaturas são analisadas pelos Tribunais Regionais Eleitorais (TREs)<br>
                    • O processo de análise pode levar até 72 horas<br>
                    • Mantenha seu TikTok atualizado para contato</p>
                </div>
                
                <!-- Stepper -->
                <div class="form-stepper">
                    <div class="step active" id="step1">
                        <div class="step-circle">1</div>
                        <div class="step-label">Dados do Candidato</div>
                    </div>
                    <div class="step" id="step2">
                        <div class="step-circle">2</div>
                        <div class="step-label">Partido e Número</div>
                    </div>
                    <div class="step" id="step3">
                        <div class="step-circle">3</div>
                        <div class="step-label">Vice/Suplente</div>
                    </div>
                    <div class="step" id="step4">
                        <div class="step-circle">4</div>
                        <div class="step-label">Foto e Declaração</div>
                    </div>
                </div>
                
                <!-- Etapa 1: Dados do Candidato -->
                <div class="form-section" id="etapa1">
                    <h3 class="form-section-title">ETAPA 1: DADOS DO CANDIDATO</h3>
                    
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-user"></i> NOME COMPLETO *</label>
                        <input type="text" class="form-input" id="candidatoNome" placeholder="Nome fictício para RP">
                        <div class="form-hint">
                            <i class="fas fa-info-circle"></i> Use um nome fictício para o Roleplay
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label"><i class="fab fa-tiktok"></i> TIKTOK (@) *</label>
                        <input type="text" class="form-input" id="candidatoTikTok" placeholder="@seudotiktok">
                        <div class="form-hint">
                            <i class="fas fa-info-circle"></i> Este será o meio de contato oficial
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-user-tie"></i> CARGO *</label>
                        <select class="form-select" id="candidatoCargo" onchange="atualizarEtapaCargo()">
                            <option value="">Selecione um cargo</option>
                            <optgroup label="Eleição Federal">
                                <option value="Presidente">Presidente</option>
                                <option value="Governador">Governador</option>
                                <option value="Senador">Senador</option>
                                <option value="Deputado Federal">Deputado Federal</option>
                                <option value="Deputado Estadual">Deputado Estadual</option>
                            </optgroup>
                            <optgroup label="Eleição Municipal">
                                <option value="Prefeito">Prefeito</option>
                                <option value="Vereador">Vereador</option>
                            </optgroup>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-user-tag"></i> IDEOLOGIA *</label>
                        <select class="form-select" id="candidatoIdeologia" onchange="filtrarPartidosPorIdeologia()">
                            <option value="">Selecione sua ideologia</option>
                            <option value="direita">Direita</option>
                            <option value="centro">Centro</option>
                            <option value="esquerda">Esquerda</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-map"></i> ESTADO *</label>
                        <select class="form-select" id="candidatoEstado" onchange="carregarCidadesCandidatura()">
                            <option value="">Selecione um estado</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-city"></i> CIDADE *</label>
                        <select class="form-select" id="candidatoCidade">
                            <option value="">Selecione uma cidade</option>
                        </select>
                    </div>
                    
                    <div style="display: flex; justify-content: flex-end; margin-top: 2rem;">
                        <button class="btn btn-primary" onclick="avancarEtapa(2)">
                            <i class="fas fa-arrow-right"></i> PRÓXIMA ETAPA
                        </button>
                    </div>
                </div>
                
                <!-- Etapa 2: Partido e Número -->
                <div class="form-section" id="etapa2" style="display: none;">
                    <h3 class="form-section-title">ETAPA 2: PARTIDO E NÚMERO</h3>
                    
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-flag"></i> PARTIDO *</label>
                        <select class="form-select" id="candidatoPartido" onchange="gerarNumeroCandidato()">
                            <option value="">Selecione um partido</option>
                        </select>
                        <div id="infoPartido" style="margin-top: 1rem;"></div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-hashtag"></i> NÚMERO DO CANDIDATO *</label>
                        <input type="text" class="form-input" id="candidatoNumero" readonly>
                        <div class="form-hint" id="hintNumero">
                            <i class="fas fa-info-circle"></i> O número será gerado automaticamente
                        </div>
                    </div>
                    
                    <!-- Coligação (apenas para cargos de 2 dígitos) -->
                    <div id="coligacaoContainer" style="display: none;">
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-handshake"></i> COLIGAÇÃO (OPCIONAL)</label>
                            <select class="form-select" id="candidatoColigacao">
                                <option value="">Selecione um partido para coligação</option>
                            </select>
                            <div class="form-hint">
                                <i class="fas fa-info-circle"></i> Coligação disponível apenas para cargos de 2 dígitos (Presidente, Governador, Prefeito)
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; margin-top: 2rem;">
                        <button class="btn btn-outline" onclick="retornarEtapa(1)">
                            <i class="fas fa-arrow-left"></i> ETAPA ANTERIOR
                        </button>
                        <button class="btn btn-primary" onclick="avancarEtapa(3)">
                            <i class="fas fa-arrow-right"></i> PRÓXIMA ETAPA
                        </button>
                    </div>
                </div>
                
                <!-- Etapa 3: Vice/Suplente -->
                <div class="form-section" id="etapa3" style="display: none;">
                    <h3 class="form-section-title">ETAPA 3: VICE-PRESIDENTE / SUPLENTE</h3>
                    
                    <div id="viceContainer">
                        <div class="info-box">
                            <h4><i class="fas fa-user-friends"></i> VICE-PRESIDENTE / VICE-GOVERNADOR / VICE-PREFEITO</h4>
                            <p>Este cargo exige um Vice que assumirá em caso de impedimento do titular.</p>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-user"></i> NOME DO VICE *</label>
                            <input type="text" class="form-input" id="viceNome" placeholder="Nome fictício do Vice">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label"><i class="fab fa-tiktok"></i> TIKTOK DO VICE (@) *</label>
                            <input type="text" class="form-input" id="viceTikTok" placeholder="@tiktokvice">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-user-tag"></i> IDEOLOGIA DO VICE *</label>
                            <select class="form-select" id="viceIdeologia">
                                <option value="">Selecione a ideologia</option>
                                <option value="direita">Direita</option>
                                <option value="centro">Centro</option>
                                <option value="esquerda">Esquerda</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-flag"></i> PARTIDO DO VICE</label>
                            <select class="form-select" id="vicePartido">
                                <option value="">Mesmo partido do candidato</option>
                            </select>
                            <div class="form-hint">
                                <i class="fas fa-info-circle"></i> O Vice pode ser de partido diferente (coligação)
                            </div>
                        </div>
                    </div>
                    
                    <div id="suplenteContainer" style="display: none;">
                        <div class="info-box">
                            <h4><i class="fas fa-user-friends"></i> SUPLENTE</h4>
                            <p>
                                <i class="fas fa-question-circle tooltip">
                                    <span class="tooltip-text">Suplente é a pessoa que assume o cargo caso o titular seja afastado, renuncie ou não possa continuar.</span>
                                </i>
                                Este cargo exige um Suplente que assumirá em caso de impedimento do titular.
                            </p>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-user"></i> NOME DO SUPLENTE *</label>
                            <input type="text" class="form-input" id="suplenteNome" placeholder="Nome fictício do Suplente">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label"><i class="fab fa-tiktok"></i> TIKTOK DO SUPLENTE (@) *</label>
                            <input type="text" class="form-input" id="suplenteTikTok" placeholder="@tiktoksuplente">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-user-tag"></i> IDEOLOGIA DO SUPLENTE *</label>
                            <select class="form-select" id="suplenteIdeologia">
                                <option value="">Selecione a ideologia</option>
                                <option value="direita">Direita</option>
                                <option value="centro">Centro</option>
                                <option value="esquerda">Esquerda</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label"><i class="fas fa-flag"></i> PARTIDO DO SUPLENTE</label>
                            <select class="form-select" id="suplentePartido">
                                <option value="">Mesmo partido do candidato</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; margin-top: 2rem;">
                        <button class="btn btn-outline" onclick="retornarEtapa(2)">
                            <i class="fas fa-arrow-left"></i> ETAPA ANTERIOR
                        </button>
                        <button class="btn btn-primary" onclick="avancarEtapa(4)">
                            <i class="fas fa-arrow-right"></i> PRÓXIMA ETAPA
                        </button>
                    </div>
                </div>
                
                <!-- Etapa 4: Foto e Declaração -->
                <div class="form-section" id="etapa4" style="display: none;">
                    <h3 class="form-section-title">ETAPA 4: FOTO E DECLARAÇÃO FINAL</h3>
                    
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-camera"></i> FOTO DO CANDIDATO *</label>
                        <div class="photo-upload" onclick="document.getElementById('fotoInput').click()">
                            <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: var(--gold); margin-bottom: 1rem;"></i>
                            <p>Clique para fazer upload da foto</p>
                            <p class="form-hint">Formatos aceitos: JPG, PNG (Máx. 5MB)</p>
                            <img id="fotoPreview" class="photo-preview" alt="Preview da foto">
                        </div>
                        <input type="file" id="fotoInput" accept="image/*" style="display: none;" onchange="previewFoto(event)">
                        <div class="form-hint">
                            <i class="fas fa-info-circle"></i> A foto deve ser fictícia e usada apenas para RP
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-file-alt"></i> DECLARAÇÃO FINAL *</label>
                        <textarea class="form-textarea" id="candidatoDeclaracao" rows="4" placeholder="Descreva brevemente suas propostas e ideais..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <div style="display: flex; align-items: center; gap: 1rem; padding: 1.5rem; background: rgba(0,0,0,0.3); border-radius: 12px;">
                            <input type="checkbox" id="declaracaoCheck" style="width: 20px; height: 20px;">
                            <label for="declaracaoCheck" style="color: var(--gold-light); font-weight: 600;">
                                DECLARO QUE TODOS OS DADOS SÃO FICTÍCIOS E FAZEM PARTE DE UM RP (ROLEPLAY)
                            </label>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; margin-top: 2rem;">
                        <button class="btn btn-outline" onclick="retornarEtapa(3)">
                            <i class="fas fa-arrow-left"></i> ETAPA ANTERIOR
                        </button>
                        <button class="btn btn-primary" onclick="enviarCandidatura()">
                            <i class="fas fa-paper-plane"></i> ENVIAR CANDIDATURA
                        </button>
                    </div>
                </div>
                
                <div id="candidaturaMessage" class="message" style="display: none;"></div>
            </div>
        </section>
        
        <!-- Partidos -->
        <section id="partidos" class="section">
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-flag"></i>
                    PARTIDOS POLÍTICOS REGISTRADOS
                </h2>
                
                <div class="filters" style="margin-bottom: 2rem;">
                    <h3><i class="fas fa-filter"></i> FILTRAR POR IDEOLOGIA</h3>
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                        <button class="btn btn-outline" onclick="filtrarPartidosExibicao('todos')">
                            <i class="fas fa-list"></i> Todos os Partidos
                        </button>
                        <button class="btn btn-outline" onclick="filtrarPartidosExibicao('direita')" style="color: #0B3C5D; border-color: #0B3C5D;">
                            <i class="fas fa-arrow-right"></i> Direita
                        </button>
                        <button class="btn btn-outline" onclick="filtrarPartidosExibicao('centro')" style="color: #FFD700; border-color: #FFD700;">
                            <i class="fas fa-minus"></i> Centro
                        </button>
                        <button class="btn btn-outline" onclick="filtrarPartidosExibicao('esquerda')" style="color: #CC0000; border-color: #CC0000;">
                            <i class="fas fa-arrow-left"></i> Esquerda
                        </button>
                    </div>
                </div>
                
                <div id="listaPartidos">
                    <!-- Lista de partidos carregada via JavaScript -->
                </div>
            </div>
        </section>
        
        <!-- Tribunais Regionais -->
        <section id="tres" class="section">
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-balance-scale"></i>
                    TRIBUNAL SUPERIOR ELEITORAL - TSE
                </h2>
                
                <div class="info-box">
                    <h3><i class="fas fa-info-circle"></i> ESTRUTURA DO SISTEMA ELEITORAL</h3>
                    <p>O sistema eleitoral de Brookasil é composto pelo TSE Nacional e pelos TREs Estaduais e Municipais.</p>
                    <p><strong>Hierarquia:</strong> TSE Nacional > TRE Estadual > TRE Municipal</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">TSE Nacional</div>
                        <div class="stat-number">1</div>
                        <div class="stat-desc">Controle total do sistema</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">TREs Estaduais</div>
                        <div class="stat-number" id="totalEstados">0</div>
                        <div class="stat-desc">Jurisdição estadual</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">TREs Municipais</div>
                        <div class="stat-number" id="totalCidades">0</div>
                        <div class="stat-desc">Jurisdição municipal</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Total de Tribunais</div>
                        <div class="stat-number" id="totalTribunais">0</div>
                        <div class="stat-desc">Em todo o Brookasil</div>
                    </div>
                </div>
                
                <div id="listaTREs">
                    <!-- Lista de TREs carregada via JavaScript -->
                </div>
            </div>
        </section>
        
        <!-- Login Administrativo -->
        <section id="login" class="section">
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-key"></i>
                    ACESSO ADMINISTRATIVO
                </h2>
                
                <div class="login-card">
                    <h3 style="color: var(--gold); margin-bottom: 0.5rem;">LOGIN POR CHAVE SEGURA</h3>
                    <p class="logo-sub" style="margin-bottom: 2rem;">TSE Nacional, TREs Estaduais e Municipais</p>
                    
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-user-tag"></i> TIPO DE ACESSO *</label>
                        <select class="form-select" id="adminType" onchange="atualizarJurisdicao()">
                            <option value="">Selecione o tipo de acesso</option>
                            <option value="TSE">TSE Nacional - Brookasil</option>
                            <option value="TRE_ESTADUAL">TRE Estadual</option>
                            <option value="TRE_MUNICIPAL">TRE Municipal</option>
                        </select>
                    </div>
                    
                    <div id="jurisdicaoContainer" style="display: none;">
                        <div class="form-group">
                            <label class="form-label" id="jurisdicaoLabel"></label>
                            <select class="form-select" id="jurisdicaoSelect">
                                <option value="">Selecione...</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-key"></i> CHAVE DE ACESSO *</label>
                        <input type="password" class="form-input" id="adminKey" placeholder="Digite a chave de acesso">
                        <div class="form-hint">
                            <i class="fas fa-shield-alt"></i> As chaves são armazenadas com criptografia avançada
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <button class="btn btn-primary" onclick="realizarLoginAdmin()">
                            <i class="fas fa-sign-in-alt"></i> ACESSAR SISTEMA
                        </button>
                    </div>
                    
                    <div class="info-box" style="margin-top: 2rem;">
                        <h4><i class="fas fa-info-circle"></i> INFORMAÇÕES DE SEGURANÇA</h4>
                        <p>• As chaves são armazenadas com hash SHA-256<br>
                        • Nunca são expostas no frontend<br>
                        • Cada tribunal tem acesso apenas à sua jurisdição<br>
                        • Apenas o TSE Nacional tem acesso completo</p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Painel Administrativo -->
        <section id="admin" class="section">
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-user-shield"></i>
                    PAINEL ADMINISTRATIVO
                </h2>
                
                <div id="adminInfo" style="margin-bottom: 2rem;"></div>
                
                <div class="stats-grid">
                    <div class="stat-card" onclick="mostrarCandidaturasPendentes()" style="cursor: pointer;">
                        <div class="stat-label">Candidaturas Pendentes</div>
                        <div class="stat-number" id="adminPendentes">0</div>
                        <div class="stat-desc">Aguardando análise</div>
                    </div>
                    
                    <div class="stat-card" onclick="mostrarCandidaturasAprovadas()" style="cursor: pointer;">
                        <div class="stat-label">Candidaturas Aprovadas</div>
                        <div class="stat-number" id="adminAprovados">0</div>
                        <div class="stat-desc">Homologadas por você</div>
                    </div>
                    
                    <div class="stat-card" onclick="mostrarCandidaturasRejeitadas()" style="cursor: pointer;">
                        <div class="stat-label">Candidaturas Rejeitadas</div>
                        <div class="stat-number" id="adminRejeitados">0</div>
                        <div class="stat-desc">Rejeitadas por você</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-label">Total na Jurisdição</div>
                        <div class="stat-number" id="adminTotal">0</div>
                        <div class="stat-desc">Candidaturas registradas</div>
                    </div>
                </div>
                
                <div id="adminContent">
                    <!-- Conteúdo administrativo será carregado aqui -->
                </div>
                
                <div style="margin-top: 2rem; display: flex; gap: 1rem; flex-wrap: wrap;">
                    <button class="btn btn-outline" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> SAIR DO SISTEMA
                    </button>
                    <button class="btn btn-outline" onclick="mostrarSecao('dashboard')">
                        <i class="fas fa-chart-bar"></i> VOLTAR AO DASHBOARD
                    </button>
                </div>
            </div>
        </section>
        
        <!-- Configurações (Apenas TSE) -->
        <section id="config" class="section">
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-cog"></i>
                    CONFIGURAÇÕES DO SISTEMA
                </h2>
                
                <div class="info-box">
                    <p><i class="fas fa-shield-alt"></i> <strong>Apenas o TSE Nacional</strong> pode alterar estas configurações</p>
                </div>
                
                <div class="form-section">
                    <h3 class="form-section-title">CONTROLE DO CICLO ELEITORAL</h3>
                    
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-vote-yea"></i> MODO DA ELEIÇÃO *</label>
                        <select class="form-select" id="configModoEleicao">
                            <option value="MUNICIPAL">🏙️ Eleição Municipal (Prefeito e Vereadores)</option>
                            <option value="FEDERAL">🇧🇷 Eleição Federal (Presidente, Governador, Senador, Deputados)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-calendar-alt"></i> STATUS DO CICLO</label>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                            <button class="btn btn-outline" onclick="alterarStatusCiclo('candidaturas_abertas')">
                                <i class="fas fa-door-open"></i> Abrir Candidaturas
                            </button>
                            <button class="btn btn-outline" onclick="alterarStatusCiclo('candidaturas_fechadas')">
                                <i class="fas fa-door-closed"></i> Fechar Candidaturas
                            </button>
                            <button class="btn btn-outline" onclick="alterarStatusCiclo('votacao_aberta')">
                                <i class="fas fa-vote-yea"></i> Abrir Votação
                            </button>
                            <button class="btn btn-outline" onclick="alterarStatusCiclo('votacao_encerrada')">
                                <i class="fas fa-ban"></i> Encerrar Votação
                            </button>
                        </div>
                    </div>
                    
                    <div class="info-box">
                        <h4><i class="fas fa-info-circle"></i> STATUS ATUAL DO CICLO</h4>
                        <p><strong>Modo da Eleição:</strong> <span id="statusModoEleicao" class="status-badge status-pendente">MUNICIPAL</span></p>
                        <p><strong>Status do Ciclo:</strong> <span id="statusCiclo" class="status-badge status-pendente">CANDIDATURAS ABERTAS</span></p>
                        <p><strong>Última Alteração:</strong> <span id="ultimaAlteracao">-</span></p>
                    </div>
                </div>
                
                <div class="form-section">
                    <h3 class="form-section-title">ORGANIZAÇÃO TERRITORIAL</h3>
                    
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-plus-circle"></i> ADICIONAR NOVO ESTADO</label>
                        <div style="display: flex; gap: 1rem;">
                            <input type="text" class="form-input" id="novoEstado" placeholder="Nome do estado">
                            <button class="btn btn-outline" onclick="adicionarEstado()">
                                <i class="fas fa-plus"></i> Adicionar
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label"><i class="fas fa-plus-circle"></i> ADICIONAR CIDADE</label>
                        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                            <select class="form-select" id="estadoParaCidade" style="flex: 1;">
                                <option value="">Selecione o estado</option>
                            </select>
                            <input type="text" class="form-input" id="novaCidade" placeholder="Nome da cidade" style="flex: 2;">
                            <button class="btn btn-outline" onclick="adicionarCidade()">
                                <i class="fas fa-plus"></i> Adicionar
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="configMessage" class="message" style="display: none;"></div>
            </div>
        </section>
        
        <!-- Logs do Sistema -->
        <section id="logs" class="section">
            <div class="card">
                <h2 class="card-title">
                    <i class="fas fa-history"></i>
                    LOGS DO SISTEMA - AUDITORIA
                </h2>
                
                <div class="filters" style="margin-bottom: 2rem;">
                    <h3><i class="fas fa-filter"></i> FILTROS AVANÇADOS</h3>
                    <div class="filter-grid">
                        <div class="filter-group">
                            <label class="filter-label"><i class="fas fa-tag"></i> TIPO DE AÇÃO</label>
                            <select class="form-select" id="filterLogTipo">
                                <option value="">Todos os Tipos</option>
                                <option value="candidatura">Nova Candidatura</option>
                                <option value="aprovar">Aprovação</option>
                                <option value="rejeitar">Rejeição</option>
                                <option value="login">Login</option>
                                <option value="logout">Logout</option>
                                <option value="config">Configuração</option>
                                <option value="sistema">Sistema</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label class="filter-label"><i class="fas fa-user"></i> USUÁRIO</label>
                            <input type="text" class="form-input" id="filterLogUsuario" placeholder="Filtrar por usuário">
                        </div>
                        
                        <div class="filter-group">
                            <label class="filter-label"><i class="fas fa-calendar"></i> DATA INICIAL</label>
                            <input type="date" class="form-input" id="filterLogDataInicio">
                        </div>
                        
                        <div class="filter-group">
                            <label class="form-label"><i class="fas fa-calendar"></i> DATA FINAL</label>
                            <input type="date" class="form-input" id="filterLogDataFim">
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                        <button class="btn btn-primary" onclick="filtrarLogs()">
                            <i class="fas fa-filter"></i> FILTRAR LOGS
                        </button>
                        <button class="btn btn-outline" onclick="resetarFiltrosLogs()">
                            <i class="fas fa-trash"></i> LIMPAR FILTROS
                        </button>
                        <button class="btn btn-outline" onclick="exportarLogs()">
                            <i class="fas fa-download"></i> EXPORTAR LOGS
                        </button>
                    </div>
                </div>
                
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>DATA/HORA</th>
                                <th>USUÁRIO</th>
                                <th>TIPO</th>
                                <th>AÇÃO</th>
                                <th>DETALHES</th>
                            </tr>
                        </thead>
                        <tbody id="logsTable">
                            <!-- Logs carregados via JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <div style="margin-top: 1rem; display: flex; justify-content: space-between; align-items: center;">
                    <span style="color: var(--cyber-blue);">Total de logs: <span id="totalLogs" class="counter">0</span></span>
                    <button class="btn btn-outline" onclick="limparLogsAntigos()">
                        <i class="fas fa-trash"></i> LIMPAR LOGS ANTIGOS
                    </button>
                </div>
            </div>
        </section>
    </main>
    
    <!-- Modal para Ações Administrativas -->
    <div id="adminModal" class="modal">
        <div class="modal-content">
            <button onclick="fecharModal()" style="position: absolute; top: 1rem; right: 1rem; background: transparent; border: none; color: var(--gold); font-size: 1.5rem; cursor: pointer;">×</button>
            <h2 class="card-title" id="modalTitulo"></h2>
            <div id="modalContent">
                <!-- Conteúdo do modal será carregado aqui -->
            </div>
        </div>
    </div>
    
    <script>
        // ============================================
        // CONSTANTES E CONFIGURAÇÕES DO SISTEMA
        // ============================================

        // Partidos (OBJETO FIXO - NÃO ALTERAR)
        const PARTIDOS_MAP = {
            direita: [
                { number: "22", name: "Partido Liberal (PL)", color: "#0B3C5D" },
                { number: "11", name: "Progressistas (PP)", color: "#1E90FF" },
                { number: "10", name: "Republicanos", color: "#4169E1" },
                { number: "30", name: "Partido Novo (NOVO)", color: "#00BFFF" },
                { number: "51", name: "Patriota", color: "#2F4F4F" },
                { number: "28", name: "Partido Renovador Trabalhista Brasileiro (PRTB)", color: "#4682B4" },
                { number: "27", name: "Democracia Cristã (DC)", color: "#5F9EA0" },
                { number: "36", name: "Agir", color: "#6495ED" },
                { number: "38", name: "União da Direita Brookasileira (UDB)", color: "#003366" },
                { number: "81", name: "Partido da Ordem e Liberdade (POL)", color: "#1C1C1C" },
                { number: "84", name: "Aliança Cristã Nacional (ACN)", color: "#2E8B57" },
                { number: "57", name: "Partido da Reedificação da Ordem Nacional (PRONA)", color: "#000080" },
                { number: "48", name: "Partido da Esperança (PESP)", color: "#228B22" },
                { number: "86", name: "Partido Militar Nacionalista (PMNL)", color: "#556B2F" },
                { number: "75", name: "Partido Republicano Trabalhista Nacional (PRTN)", color: "#191970" }
            ],

            centro: [
                { number: "15", name: "Movimento Democrático Brasileiro (MDB)", color: "#FFD700" },
                { number: "44", name: "União Brasil", color: "#FFA500" },
                { number: "55", name: "Partido Social Democrático (PSD)", color: "#FFB347" },
                { number: "20", name: "Podemos", color: "#FF8C00" },
                { number: "45", name: "Partido da Social Democracia Brasileira (PSDB)", color: "#FFDAB9" },
                { number: "77", name: "Solidariedade", color: "#F4A460" },
                { number: "70", name: "Avante", color: "#DAA520" },
                { number: "33", name: "Partido da Mobilização Nacional (PMN)", color: "#EEC900" },
                { number: "43", name: "Partido Verde (PV)", color: "#9ACD32" },
                { number: "42", name: "Partido da União Nacional (PUN)", color: "#F5DEB3" },
                { number: "37", name: "Movimento Popular Democrático (MPD)", color: "#FFD966" },
                { number: "26", name: "Partido da Mudança (PDM)", color: "#FFC04D" },
                { number: "63", name: "Movimento Trabalhista Brookasileiro (MTB)", color: "#FFE4B5" },
                { number: "46", name: "Partido Trabalhista Democrático (PTD)", color: "#FFD39B" },
                { number: "88", name: "Partido do Sindicato Democrata (PDSD)", color: "#EEDC82" },
                { number: "14", name: "Partido Missão (MSS)", color: "#FFCC99" },
                { number: "85", name: "Partido Construção (PC)", color: "#F0E68C" }
            ],

            esquerda: [
                { number: "13", name: "Partido dos Trabalhadores (PT)", color: "#CC0000" },
                { number: "50", name: "Partido Socialismo e Liberdade (PSOL)", color: "#FF4C4C" },
                { number: "65", name: "Partido Comunista do Brasil (PCdoB)", color: "#B22222" },
                { number: "18", name: "Rede Sustentabilidade (REDE)", color: "#32CD32" },
                { number: "12", name: "Partido Democrático Trabalhista (PDT)", color: "#DC143C" },
                { number: "80", name: "Unidade Popular (UP)", color: "#8B0000" },
                { number: "29", name: "Partido da Causa Operária (PCO)", color: "#A00000" },
                { number: "21", name: "Partido Comunista Brasileiro (PCB)", color: "#7B0000" },
                { number: "16", name: "Partido Socialista dos Trabalhadores Unificado (PSTU)", color: "#FF0000" },
                { number: "54", name: "Partido Pátria Livre (PPL)", color: "#C00000" },
                { number: "40", name: "Partido Socialista Brasileiro (PSB)", color: "#E60026" },
                { number: "60", name: "Partido da Frente Socialista (PFS)", color: "#B30000" },
                { number: "56", name: "Partido Socialista (PS)", color: "#990000" },
                { number: "31", name: "Partido Social Trabalhista Nacional (PSTN)", color: "#CD2626" }
            ]
        };

        // Configuração de dígitos por cargo
        const DIGITOS_POR_CARGO = {
            "Presidente": 2,
            "Governador": 2,
            "Prefeito": 2,
            "Senador": 3,
            "Deputado Federal": 4,
            "Deputado Estadual": 5,
            "Vereador": 5
        };

        // Cargos que exigem Vice
        const CARGOS_COM_VICE = ["Presidente", "Governador", "Prefeito"];
        
        // Cargos que exigem Suplente
        const CARGOS_COM_SUPLENTE = ["Senador", "Deputado Federal", "Deputado Estadual", "Vereador"];

        // Limites por partido (conforme especificação)
        const LIMITES_PARTIDO = {
            "Presidente": { escopo: "pais", limite: 1 },
            "Governador": { escopo: "estado", limite: 1 },
            "Senador": { escopo: "estado", limite: 4 },
            "Deputado Federal": { escopo: "cidade", limite: 4 },
            "Deputado Estadual": { escopo: "estado", limite: 4 },
            "Prefeito": { escopo: "cidade", limite: 1 },
            "Vereador": { escopo: "cidade", limite: 4 }
        };

        // Estados e Cidades iniciais (serão gerenciados pelo TSE)
        let estados = [];
        let cidades = [];

        // ============================================
        // ESTADO DO SISTEMA
        // ============================================

        let usuarioLogado = null;
        let candidatos = [];
        let logs = [];
        let configuracaoSistema = {
            modoEleicao: "MUNICIPAL",
            statusCiclo: "candidaturas_abertas",
            dataInicio: new Date().toISOString(),
            ultimaAlteracao: null
        };

        // ============================================
        // INICIALIZAÇÃO DO SISTEMA
        // ============================================

        document.addEventListener('DOMContentLoaded', function() {
            carregarDados();
            inicializarSelects();
            atualizarDashboard();
            
            // Verificar se há usuário logado
            const usuarioSalvo = localStorage.getItem('tse_usuario_logado');
            if (usuarioSalvo) {
                usuarioLogado = JSON.parse(usuarioSalvo);
                entrarModoAdmin();
            }
            
            // Verificar status da sidebar
            const sidebarHidden = localStorage.getItem('sidebar_hidden');
            if (sidebarHidden === 'true') {
                toggleSidebar();
            }
        });

        function carregarDados() {
            // Carregar estados e cidades
            const estadosSalvos = localStorage.getItem('tse_estados');
            const cidadesSalvas = localStorage.getItem('tse_cidades');
            
            if (estadosSalvos) {
                estados = JSON.parse(estadosSalvos);
            } else {
                // Estados iniciais para demonstração
                estados = [
                    { id: 1, nome: "Brookhaven", presidente: "Tutu Protásio" },
                    { id: 2, nome: "Novacore", presidente: "William Harris" },
                    { id: 3, nome: "Casteríber", presidente: "Henrique Camilote" }
                ];
                salvarEstados();
            }
            
            if (cidadesSalvas) {
                cidades = JSON.parse(cidadesSalvas);
            } else {
                // Cidades iniciais para demonstração (mínimo 3 por estado)
                cidades = [
                    { id: 1, nome: "Cidade Eleitoral", estadoId: 1, presidente: "Tutu Protásio" },
                    { id: 2, nome: "Liberty City", estadoId: 1, presidente: "Ronaldo Caiado" },
                    { id: 3, nome: "Central Park", estadoId: 1, presidente: "Maria Silva" },
                    { id: 4, nome: "Nexaville", estadoId: 2, presidente: "William Harris" },
                    { id: 5, nome: "Solária", estadoId: 2, presidente: "Ryan Mendonça" },
                    { id: 6, nome: "Tech Valley", estadoId: 2, presidente: "Ana Costa" },
                    { id: 7, nome: "Castelo Verde", estadoId: 3, presidente: "Henrique Camilote" },
                    { id: 8, nome: "Monte Prata", estadoId: 3, presidente: "Jacinto Leite" },
                    { id: 9, nome: "Vale Dourado", estadoId: 3, presidente: "Carla Santos" }
                ];
                salvarCidades();
            }
            
            // Carregar candidatos
            const candidatosSalvos = localStorage.getItem('tse_candidatos');
            if (candidatosSalvos) {
                candidatos = JSON.parse(candidatosSalvos);
            }
            
            // Carregar logs
            const logsSalvos = localStorage.getItem('tse_logs');
            if (logsSalvos) {
                logs = JSON.parse(logsSalvos);
            }
            
            // Carregar configuração do sistema
            const configSalva = localStorage.getItem('tse_configuracao');
            if (configSalva) {
                configuracaoSistema = JSON.parse(configSalva);
                atualizarInterfaceConfiguracao();
            }
            
            // Registrar log de inicialização
            registrarLog('sistema', 'Sistema inicializado', 'Sistema');
        }

        function salvarEstados() {
            localStorage.setItem('tse_estados', JSON.stringify(estados));
        }

        function salvarCidades() {
            localStorage.setItem('tse_cidades', JSON.stringify(cidades));
        }

        function salvarCandidatos() {
            localStorage.setItem('tse_candidatos', JSON.stringify(candidatos));
        }

        function salvarLogs() {
            localStorage.setItem('tse_logs', JSON.stringify(logs));
        }

        function salvarConfiguracao() {
            localStorage.setItem('tse_configuracao', JSON.stringify(configuracaoSistema));
        }

        function inicializarSelects() {
            // Estados para filtros
            const filterEstado = document.getElementById('filterEstado');
            const candidatoEstado = document.getElementById('candidatoEstado');
            const estadoParaCidade = document.getElementById('estadoParaCidade');
            
            filterEstado.innerHTML = '<option value="">Todos os Estados</option>';
            candidatoEstado.innerHTML = '<option value="">Selecione um estado</option>';
            estadoParaCidade.innerHTML = '<option value="">Selecione o estado</option>';
            
            estados.forEach(estado => {
                const option1 = document.createElement('option');
                option1.value = estado.id;
                option1.textContent = estado.nome;
                filterEstado.appendChild(option1);
                
                const option2 = document.createElement('option');
                option2.value = estado.id;
                option2.textContent = estado.nome;
                candidatoEstado.appendChild(option2);
                
                const option3 = document.createElement('option');
                option3.value = estado.id;
                option3.textContent = estado.nome;
                estadoParaCidade.appendChild(option3);
            });
            
            // Partidos para filtro
            const filterPartido = document.getElementById('filterPartido');
            filterPartido.innerHTML = '<option value="">Todos os Partidos</option>';
            
            for (const ideologia in PARTIDOS_MAP) {
                PARTIDOS_MAP[ideologia].forEach(partido => {
                    const option = document.createElement('option');
                    option.value = partido.number;
                    option.textContent = `${partido.number} - ${partido.name}`;
                    filterPartido.appendChild(option);
                });
            }
        }

        // ============================================
        // NAVEGAÇÃO E INTERFACE
        // ============================================

        function mostrarSecao(sectionId) {
            // Esconder todas as seções
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remover active de todos os itens da sidebar
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Mostrar seção selecionada
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.add('active');
                
                // Ativar item correspondente na sidebar
                const sidebarItem = document.querySelector(`.sidebar-item[onclick*="${sectionId}"]`);
                if (sidebarItem) {
                    sidebarItem.classList.add('active');
                }
                
                // Executar ações específicas da seção
                switch(sectionId) {
                    case 'dashboard':
                        atualizarDashboard();
                        break;
                    case 'candidatos':
                        carregarCandidatosPublicos();
                        break;
                    case 'candidatura':
                        resetarFormularioCandidatura();
                        break;
                    case 'partidos':
                        carregarListaPartidos();
                        break;
                    case 'tres':
                        carregarListaTREs();
                        break;
                    case 'admin':
                        if (usuarioLogado) mostrarDashboardAdmin();
                        break;
                    case 'logs':
                        carregarLogs();
                        break;
                    case 'config':
                        if (usuarioLogado && usuarioLogado.tipo === 'TSE') {
                            carregarConfiguracao();
                        }
                        break;
                }
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('mainContent');
            const toggleIcon = document.querySelector('.sidebar-toggle i');
            
            sidebar.classList.toggle('hidden');
            mainContent.classList.toggle('expanded');
            
            if (sidebar.classList.contains('hidden')) {
                toggleIcon.className = 'fas fa-chevron-right';
                localStorage.setItem('sidebar_hidden', 'true');
            } else {
                toggleIcon.className = 'fas fa-chevron-left';
                localStorage.setItem('sidebar_hidden', 'false');
            }
        }

        // ============================================
        // DASHBOARD E GRÁFICOS
        // ============================================

        function atualizarDashboard() {
            // Atualizar contadores
            const total = candidatos.length;
            const aprovados = candidatos.filter(c => c.status === 'APROVADO').length;
            const pendentes = candidatos.filter(c => c.status === 'PENDENTE').length;
            const rejeitados = candidatos.filter(c => c.status === 'REJEITADO').length;
            
            document.getElementById('totalCandidatos').textContent = total;
            document.getElementById('aprovados').textContent = aprovados;
            document.getElementById('pendentes').textContent = pendentes;
            document.getElementById('rejeitados').textContent = rejeitados;
            
            // Atualizar modo da eleição
            const modoEleicao = document.getElementById('modoEleicao');
            const currentElectionMode = document.getElementById('currentElectionMode');
            
            if (configuracaoSistema.modoEleicao === 'MUNICIPAL') {
                modoEleicao.textContent = 'MUNICIPAL';
                currentElectionMode.textContent = 'ELEIÇÃO MUNICIPAL';
                document.querySelector('.mode-indicator').className = 'mode-indicator mode-municipal';
            } else {
                modoEleicao.textContent = 'FEDERAL';
                currentElectionMode.textContent = 'ELEIÇÃO FEDERAL';
                document.querySelector('.mode-indicator').className = 'mode-indicator mode-federal';
            }
            
            // Atualizar gráficos
            atualizarGraficos();
        }

        function atualizarGraficos() {
            // Gráfico de ideologias
            const ideologiaData = {
                'Direita': candidatos.filter(c => c.ideologia === 'direita').length,
                'Centro': candidatos.filter(c => c.ideologia === 'centro').length,
                'Esquerda': candidatos.filter(c => c.ideologia === 'esquerda').length
            };
            
            const ideologiaCtx = document.getElementById('ideologiaChart').getContext('2d');
            new Chart(ideologiaCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(ideologiaData),
                    datasets: [{
                        data: Object.values(ideologiaData),
                        backgroundColor: ['#0B3C5D', '#FFD700', '#CC0000'],
                        borderColor: ['#fff', '#fff', '#fff'],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#ffd700',
                                font: {
                                    family: 'Orbitron'
                                }
                            }
                        }
                    }
                }
            });
            
            // Gráfico de cargos
            const cargoData = {};
            candidatos.forEach(c => {
                cargoData[c.cargo] = (cargoData[c.cargo] || 0) + 1;
            });
            
            const cargoCtx = document.getElementById('cargoChart').getContext('2d');
            new Chart(cargoCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(cargoData),
                    datasets: [{
                        label: 'Candidatos',
                        data: Object.values(cargoData),
                        backgroundColor: '#ffd700',
                        borderColor: '#fff',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#ffd700',
                                font: {
                                    family: 'Orbitron'
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: '#ffd700'
                            },
                            grid: {
                                color: 'rgba(255, 215, 0, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#ffd700'
                            },
                            grid: {
                                color: 'rgba(255, 215, 0, 0.1)'
                            }
                        }
                    }
                }
            });
            
            // Gráfico por estado
            const estadoData = {};
            candidatos.forEach(c => {
                const estado = estados.find(e => e.id === c.estadoId);
                if (estado) {
                    estadoData[estado.nome] = (estadoData[estado.nome] || 0) + 1;
                }
            });
            
            const estadoCtx = document.getElementById('estadoChart').getContext('2d');
            new Chart(estadoCtx, {
                type: 'polarArea',
                data: {
                    labels: Object.keys(estadoData),
                    datasets: [{
                        data: Object.values(estadoData),
                        backgroundColor: [
                            '#ffd700',
                            '#00f3ff',
                            '#ff00ff',
                            '#23d160',
                            '#ff3860',
                            '#9d4edd',
                            '#00ffc3'
                        ],
                        borderColor: '#fff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#ffd700',
                                font: {
                                    family: 'Orbitron'
                                }
                            }
                        }
                    }
                }
            });
            
            // Gráfico por partido (top 10)
            const partidoData = {};
            candidatos.forEach(c => {
                partidoData[c.partidoNumero] = (partidoData[c.partidoNumero] || 0) + 1;
            });
            
            // Ordenar e pegar top 10
            const topPartidos = Object.entries(partidoData)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 10);
            
            const partidoCtx = document.getElementById('partidoChart').getContext('2d');
            new Chart(partidoCtx, {
                type: 'horizontalBar',
                data: {
                    labels: topPartidos.map(p => p[0]),
                    datasets: [{
                        label: 'Candidatos',
                        data: topPartidos.map(p => p[1]),
                        backgroundColor: '#00ffc3',
                        borderColor: '#fff',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#ffd700',
                                font: {
                                    family: 'Orbitron'
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            ticks: {
                                color: '#ffd700'
                            },
                            grid: {
                                color: 'rgba(255, 215, 0, 0.1)'
                            }
                        },
                        x: {
                            beginAtZero: true,
                            ticks: {
                                color: '#ffd700'
                            },
                            grid: {
                                color: 'rgba(255, 215, 0, 0.1)'
                            }
                        }
                    }
                }
            });
        }

        // ============================================
        // CANDIDATOS PÚBLICOS
        // ============================================

        function carregarCandidatosPublicos() {
            const tbody = document.getElementById('candidatosTable');
            tbody.innerHTML = '';
            
            if (candidatos.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 3rem;">
                            <div class="loader"></div>
                            <p style="color: var(--cyber-blue); margin-top: 1rem;">Carregando candidatos...</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Se não for admin, mostrar apenas aprovados
            let candidatosExibidos = candidatos;
            if (!usuarioLogado) {
                candidatosExibidos = candidatos.filter(c => c.status === 'APROVADO');
            }
            
            if (candidatosExibidos.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 3rem; color: var(--cyber-blue);">
                            <i class="fas fa-users" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                            <p>Nenhum candidato disponível para exibição pública.</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            candidatosExibidos.forEach(candidato => {
                const estado = estados.find(e => e.id === candidato.estadoId);
                const cidade = cidades.find(c => c.id === candidato.cidadeId);
                const partido = encontrarPartidoPorNumero(candidato.partidoNumero);
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><span class="candidate-number">${candidato.numero}</span></td>
                    <td>
                        <strong>${candidato.nome}</strong><br>
                        <small style="color: var(--cyber-blue);">${candidato.tiktok}</small>
                    </td>
                    <td>${candidato.cargo}</td>
                    <td>${candidato.partidoNumero} - ${partido ? partido.name.split('(')[0] : 'N/A'}</td>
                    <td>${cidade ? cidade.nome : 'N/A'} / ${estado ? estado.nome : 'N/A'}</td>
                    <td><span class="ideologia-tag ideologia-${candidato.ideologia}">${candidato.ideologia}</span></td>
                    <td><span class="status-badge status-${candidato.status.toLowerCase()}">${candidato.status}</span></td>
                    <td>
                        <button class="btn btn-outline" style="padding: 0.5rem 1rem; font-size: 0.9rem;" onclick="verDetalhesCandidato(${candidato.id})">
                            <i class="fas fa-eye"></i> Detalhes
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function filtrarCandidatos() {
            const estadoId = document.getElementById('filterEstado').value;
            const cargo = document.getElementById('filterCargo').value;
            const ideologia = document.getElementById('filterIdeologia').value;
            const partidoNumero = document.getElementById('filterPartido').value;
            const status = document.getElementById('filterStatus').value;
            
            let candidatosFiltrados = [...candidatos];
            
            // Aplicar filtros
            if (estadoId) {
                candidatosFiltrados = candidatosFiltrados.filter(c => c.estadoId == estadoId);
            }
            
            if (cargo) {
                candidatosFiltrados = candidatosFiltrados.filter(c => c.cargo === cargo);
            }
            
            if (ideologia) {
                candidatosFiltrados = candidatosFiltrados.filter(c => c.ideologia === ideologia);
            }
            
            if (partidoNumero) {
                candidatosFiltrados = candidatosFiltrados.filter(c => c.partidoNumero === partidoNumero);
            }
            
            if (status) {
                candidatosFiltrados = candidatosFiltrados.filter(c => c.status === status);
            }
            
            // Se não for admin, mostrar apenas aprovados
            if (!usuarioLogado) {
                candidatosFiltrados = candidatosFiltrados.filter(c => c.status === 'APROVADO');
            }
            
            const tbody = document.getElementById('candidatosTable');
            tbody.innerHTML = '';
            
            if (candidatosFiltrados.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 3rem; color: var(--cyber-blue);">
                            <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                            <p>Nenhum candidato encontrado com os filtros aplicados.</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            candidatosFiltrados.forEach(candidato => {
                const estado = estados.find(e => e.id === candidato.estadoId);
                const cidade = cidades.find(c => c.id === candidato.cidadeId);
                const partido = encontrarPartidoPorNumero(candidato.partidoNumero);
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><span class="candidate-number">${candidato.numero}</span></td>
                    <td>
                        <strong>${candidato.nome}</strong><br>
                        <small style="color: var(--cyber-blue);">${candidato.tiktok}</small>
                    </td>
                    <td>${candidato.cargo}</td>
                    <td>${candidato.partidoNumero} - ${partido ? partido.name.split('(')[0] : 'N/A'}</td>
                    <td>${cidade ? cidade.nome : 'N/A'} / ${estado ? estado.nome : 'N/A'}</td>
                    <td><span class="ideologia-tag ideologia-${candidato.ideologia}">${candidato.ideologia}</span></td>
                    <td><span class="status-badge status-${candidato.status.toLowerCase()}">${candidato.status}</span></td>
                    <td>
                        <button class="btn btn-outline" style="padding: 0.5rem 1rem; font-size: 0.9rem;" onclick="verDetalhesCandidato(${candidato.id})">
                            <i class="fas fa-eye"></i> Detalhes
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function resetarFiltros() {
            document.getElementById('filterEstado').value = '';
            document.getElementById('filterCidade').value = '';
            document.getElementById('filterCargo').value = '';
            document.getElementById('filterIdeologia').value = '';
            document.getElementById('filterPartido').value = '';
            document.getElementById('filterStatus').value = '';
            carregarCandidatosPublicos();
        }

        // ============================================
        // FORMULÁRIO DE CANDIDATURA
        // ============================================

        let etapaAtual = 1;

        function avancarEtapa(novaEtapa) {
            // Validar etapa atual antes de avançar
            if (!validarEtapa(etapaAtual)) {
                return;
            }
            
            // Esconder etapa atual
            document.getElementById(`etapa${etapaAtual}`).style.display = 'none';
            document.getElementById(`step${etapaAtual}`).classList.remove('active');
            
            // Mostrar nova etapa
            document.getElementById(`etapa${novaEtapa}`).style.display = 'block';
            document.getElementById(`step${novaEtapa}`).classList.add('active');
            
            etapaAtual = novaEtapa;
            
            // Ações específicas da nova etapa
            if (novaEtapa === 2) {
                filtrarPartidosPorIdeologia();
                gerarNumeroCandidato();
            } else if (novaEtapa === 3) {
                configurarViceSuplente();
            }
        }

        function retornarEtapa(etapaAnterior) {
            // Esconder etapa atual
            document.getElementById(`etapa${etapaAtual}`).style.display = 'none';
            document.getElementById(`step${etapaAtual}`).classList.remove('active');
            
            // Mostrar etapa anterior
            document.getElementById(`etapa${etapaAnterior}`).style.display = 'block';
            document.getElementById(`step${etapaAnterior}`).classList.add('active');
            
            etapaAtual = etapaAnterior;
        }

        function validarEtapa(etapa) {
            switch(etapa) {
                case 1:
                    const nome = document.getElementById('candidatoNome').value.trim();
                    const tiktok = document.getElementById('candidatoTikTok').value.trim();
                    const cargo = document.getElementById('candidatoCargo').value;
                    const ideologia = document.getElementById('candidatoIdeologia').value;
                    const estado = document.getElementById('candidatoEstado').value;
                    const cidade = document.getElementById('candidatoCidade').value;
                    
                    if (!nome || !tiktok || !cargo || !ideologia || !estado || !cidade) {
                        mostrarMensagem('candidaturaMessage', '❌ Preencha todos os campos da Etapa 1!', 'error');
                        return false;
                    }
                    
                    if (!tiktok.startsWith('@')) {
                        mostrarMensagem('candidaturaMessage', '❌ O TikTok deve começar com @!', 'error');
                        return false;
                    }
                    
                    return true;
                    
                case 2:
                    const partido = document.getElementById('candidatoPartido').value;
                    if (!partido) {
                        mostrarMensagem('candidaturaMessage', '❌ Selecione um partido!', 'error');
                        return false;
                    }
                    
                    // Verificar se o número foi gerado
                    const numero = document.getElementById('candidatoNumero').value;
                    if (!numero) {
                        mostrarMensagem('candidaturaMessage', '❌ Gere o número do candidato!', 'error');
                        return false;
                    }
                    
                    // Verificar unicidade do número
                    if (!validarUnicidadeNumero(numero, cargo)) {
                        mostrarMensagem('candidaturaMessage', '❌ Este número já está em uso para este cargo!', 'error');
                        return false;
                    }
                    
                    return true;
                    
                case 3:
                    const cargoAtual = document.getElementById('candidatoCargo').value;
                    
                    if (CARGOS_COM_VICE.includes(cargoAtual)) {
                        const viceNome = document.getElementById('viceNome').value.trim();
                        const viceTikTok = document.getElementById('viceTikTok').value.trim();
                        const viceIdeologia = document.getElementById('viceIdeologia').value;
                        
                        if (!viceNome || !viceTikTok || !viceIdeologia) {
                            mostrarMensagem('candidaturaMessage', '❌ Preencha todos os dados do Vice!', 'error');
                            return false;
                        }
                        
                        if (!viceTikTok.startsWith('@')) {
                            mostrarMensagem('candidaturaMessage', '❌ O TikTok do Vice deve começar com @!', 'error');
                            return false;
                        }
                    }
                    
                    if (CARGOS_COM_SUPLENTE.includes(cargoAtual)) {
                        const suplenteNome = document.getElementById('suplenteNome').value.trim();
                        const suplenteTikTok = document.getElementById('suplenteTikTok').value.trim();
                        const suplenteIdeologia = document.getElementById('suplenteIdeologia').value;
                        
                        if (!suplenteNome || !suplenteTikTok || !suplenteIdeologia) {
                            mostrarMensagem('candidaturaMessage', '❌ Preencha todos os dados do Suplente!', 'error');
                            return false;
                        }
                        
                        if (!suplenteTikTok.startsWith('@')) {
                            mostrarMensagem('candidaturaMessage', '❌ O TikTok do Suplente deve começar com @!', 'error');
                            return false;
                        }
                    }
                    
                    return true;
                    
                default:
                    return true;
            }
        }

        function atualizarEtapaCargo() {
            const cargo = document.getElementById('candidatoCargo').value;
            const hintNumero = document.getElementById('hintNumero');
            
            if (cargo) {
                const digitos = DIGITOS_POR_CARGO[cargo] || 2;
                hintNumero.innerHTML = `<i class="fas fa-info-circle"></i> Este cargo usa ${digitos} dígitos (${digitos === 2 ? 'número do partido' : 'partido + dígitos livres'})`;
                
                // Mostrar/ocultar coligação
                const coligacaoContainer = document.getElementById('coligacaoContainer');
                if (digitos === 2) {
                    coligacaoContainer.style.display = 'block';
                } else {
                    coligacaoContainer.style.display = 'none';
                }
            }
        }

        function carregarCidadesCandidatura() {
            const estadoId = document.getElementById('candidatoEstado').value;
            const selectCidade = document.getElementById('candidatoCidade');
            selectCidade.innerHTML = '<option value="">Selecione uma cidade</option>';
            
            if (estadoId) {
                const cidadesEstado = cidades.filter(c => c.estadoId == estadoId);
                cidadesEstado.forEach(cidade => {
                    const option = document.createElement('option');
                    option.value = cidade.id;
                    option.textContent = cidade.nome;
                    selectCidade.appendChild(option);
                });
            }
        }

        function filtrarPartidosPorIdeologia() {
            const ideologia = document.getElementById('candidatoIdeologia').value;
            const selectPartido = document.getElementById('candidatoPartido');
            selectPartido.innerHTML = '<option value="">Selecione um partido</option>';
            
            if (ideologia && PARTIDOS_MAP[ideologia]) {
                PARTIDOS_MAP[ideologia].forEach(partido => {
                    const option = document.createElement('option');
                    option.value = partido.number;
                    option.textContent = `${partido.number} - ${partido.name}`;
                    selectPartido.appendChild(option);
                });
                
                // Atualizar coligação
                const selectColigacao = document.getElementById('candidatoColigacao');
                selectColigacao.innerHTML = '<option value="">Selecione um partido para coligação</option>';
                
                // Para coligação, mostrar partidos ideologicamente compatíveis
                let partidosCompativeis = [];
                if (ideologia === 'direita') {
                    partidosCompativeis = [...PARTIDOS_MAP['direita'], ...PARTIDOS_MAP['centro']];
                } else if (ideologia === 'centro') {
                    partidosCompativeis = [...PARTIDOS_MAP['direita'], ...PARTIDOS_MAP['centro'], ...PARTIDOS_MAP['esquerda']];
                } else if (ideologia === 'esquerda') {
                    partidosCompativeis = [...PARTIDOS_MAP['centro'], ...PARTIDOS_MAP['esquerda']];
                }
                
                partidosCompativeis.forEach(partido => {
                    const option = document.createElement('option');
                    option.value = partido.number;
                    option.textContent = `${partido.number} - ${partido.name}`;
                    selectColigacao.appendChild(option);
                });
            }
        }

        function gerarNumeroCandidato() {
            const cargo = document.getElementById('candidatoCargo').value;
            const partidoNumero = document.getElementById('candidatoPartido').value;
            
            if (!cargo || !partidoNumero) {
                document.getElementById('candidatoNumero').value = '';
                return;
            }
            
            const digitos = DIGITOS_POR_CARGO[cargo] || 2;
            let numero = partidoNumero;
            
            // Adicionar dígitos livres conforme necessário
            if (digitos > 2) {
                const digitosLivres = digitos - 2;
                for (let i = 0; i < digitosLivres; i++) {
                    numero += Math.floor(Math.random() * 10);
                }
            }
            
            document.getElementById('candidatoNumero').value = numero;
            
            // Atualizar informações do partido
            const partido = encontrarPartidoPorNumero(partidoNumero);
            const infoPartido = document.getElementById('infoPartido');
            
            if (partido) {
                infoPartido.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 1rem; padding: 1rem; background: rgba(0,0,0,0.3); border-radius: 12px;">
                        <div style="width: 30px; height: 30px; background: ${partido.color}; border-radius: 6px;"></div>
                        <div>
                            <strong style="color: var(--gold);">${partido.name}</strong>
                            <div style="margin-top: 0.5rem;">
                                <span class="ideologia-tag ideologia-${Object.keys(PARTIDOS_MAP).find(k => PARTIDOS_MAP[k].some(p => p.number === partidoNumero))}">
                                    ${Object.keys(PARTIDOS_MAP).find(k => PARTIDOS_MAP[k].some(p => p.number === partidoNumero))}
                                </span>
                            </div>
                        </div>
                    </div>
                `;
                infoPartido.style.display = 'block';
            }
        }

        function validarUnicidadeNumero(numero, cargo) {
            // Verificar se já existe candidato com mesmo número para o mesmo cargo
            const cargoAtual = document.getElementById('candidatoCargo').value;
            const estadoId = document.getElementById('candidatoEstado').value;
            const cidadeId = document.getElementById('candidatoCidade').value;
            
            const candidatosExistentes = candidatos.filter(c => 
                c.numero === numero && 
                c.cargo === cargoAtual &&
                c.status !== 'REJEITADO' // Ignorar rejeitados
            );
            
            if (candidatosExistentes.length === 0) {
                return true;
            }
            
            // Verificar escopo da unicidade
            const limite = LIMITES_PARTIDO[cargoAtual];
            if (!limite) return true;
            
            if (limite.escopo === 'pais') {
                // Número único no país
                return false;
            } else if (limite.escopo === 'estado') {
                // Número único no estado
                return !candidatosExistentes.some(c => c.estadoId == estadoId);
            } else if (limite.escopo === 'cidade') {
                // Número único na cidade
                return !candidatosExistentes.some(c => c.cidadeId == cidadeId);
            }
            
            return true;
        }

        function configurarViceSuplente() {
            const cargo = document.getElementById('candidatoCargo').value;
            const viceContainer = document.getElementById('viceContainer');
            const suplenteContainer = document.getElementById('suplenteContainer');
            
            if (CARGOS_COM_VICE.includes(cargo)) {
                viceContainer.style.display = 'block';
                suplenteContainer.style.display = 'none';
                
                // Popular partidos para vice
                const ideologia = document.getElementById('candidatoIdeologia').value;
                const selectVicePartido = document.getElementById('vicePartido');
                selectVicePartido.innerHTML = '<option value="">Mesmo partido do candidato</option>';
                
                if (ideologia && PARTIDOS_MAP[ideologia]) {
                    PARTIDOS_MAP[ideologia].forEach(partido => {
                        const option = document.createElement('option');
                        option.value = partido.number;
                        option.textContent = `${partido.number} - ${partido.name}`;
                        selectVicePartido.appendChild(option);
                    });
                }
            } else if (CARGOS_COM_SUPLENTE.includes(cargo)) {
                viceContainer.style.display = 'none';
                suplenteContainer.style.display = 'block';
                
                // Popular partidos para suplente
                const ideologia = document.getElementById('candidatoIdeologia').value;
                const selectSuplentePartido = document.getElementById('suplentePartido');
                selectSuplentePartido.innerHTML = '<option value="">Mesmo partido do candidato</option>';
                
                if (ideologia && PARTIDOS_MAP[ideologia]) {
                    PARTIDOS_MAP[ideologia].forEach(partido => {
                        const option = document.createElement('option');
                        option.value = partido.number;
                        option.textContent = `${partido.number} - ${partido.name}`;
                        selectSuplentePartido.appendChild(option);
                    });
                }
            }
        }

        function previewFoto(event) {
            const input = event.target;
            const preview = document.getElementById('fotoPreview');
            
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                };
                
                reader.readAsDataURL(input.files[0]);
            }
        }

        function enviarCandidatura() {
            // Validar etapa 4
            if (!validarEtapa(4)) {
                return;
            }
            
            // Validar checkbox de declaração
            const declaracaoCheck = document.getElementById('declaracaoCheck');
            if (!declaracaoCheck.checked) {
                mostrarMensagem('candidaturaMessage', '❌ Você deve declarar que todos os dados são fictícios!', 'error');
                return;
            }
            
            // Validar foto
            const fotoInput = document.getElementById('fotoInput');
            if (!fotoInput.files || fotoInput.files.length === 0) {
                mostrarMensagem('candidaturaMessage', '❌ Faça upload da foto do candidato!', 'error');
                return;
            }
            
            // Coletar dados
            const candidatura = {
                id: Date.now(),
                nome: document.getElementById('candidatoNome').value.trim(),
                tiktok: document.getElementById('candidatoTikTok').value.trim(),
                cargo: document.getElementById('candidatoCargo').value,
                ideologia: document.getElementById('candidatoIdeologia').value,
                estadoId: parseInt(document.getElementById('candidatoEstado').value),
                cidadeId: parseInt(document.getElementById('candidatoCidade').value),
                partidoNumero: document.getElementById('candidatoPartido').value,
                numero: document.getElementById('candidatoNumero').value,
                coligacao: document.getElementById('candidatoColigacao').value || null,
                declaracao: document.getElementById('candidatoDeclaracao').value.trim(),
                foto: fotoInput.files[0].name, // Apenas o nome do arquivo
                status: 'PENDENTE',
                dataCadastro: new Date().toISOString(),
                analisePor: null,
                motivoRejeicao: null,
                dataAnalise: null
            };
            
            // Adicionar vice/suplente
            const cargo = candidatura.cargo;
            if (CARGOS_COM_VICE.includes(cargo)) {
                candidatura.vice = {
                    nome: document.getElementById('viceNome').value.trim(),
                    tiktok: document.getElementById('viceTikTok').value.trim(),
                    ideologia: document.getElementById('viceIdeologia').value,
                    partidoNumero: document.getElementById('vicePartido').value || candidatura.partidoNumero
                };
            } else if (CARGOS_COM_SUPLENTE.includes(cargo)) {
                candidatura.suplente = {
                    nome: document.getElementById('suplenteNome').value.trim(),
                    tiktok: document.getElementById('suplenteTikTok').value.trim(),
                    ideologia: document.getElementById('suplenteIdeologia').value,
                    partidoNumero: document.getElementById('suplentePartido').value || candidatura.partidoNumero
                };
            }
            
            // Verificar limites do partido
            if (!validarLimitesPartido(candidatura)) {
                mostrarMensagem('candidaturaMessage', '❌ Limite de candidatos por partido atingido para este cargo!', 'error');
                return;
            }
            
            // Adicionar candidatura
            candidatos.push(candidatura);
            salvarCandidatos();
            
            // Registrar log
            registrarLog('candidatura', `Nova candidatura: ${candidatura.nome} (${candidatura.partidoNumero}) para ${candidatura.cargo}`, 'Público');
            
            // Mostrar mensagem de sucesso
            mostrarMensagem('candidaturaMessage', '✅ Candidatura enviada com sucesso! Aguarde análise do TRE correspondente.', 'success');
            
            // Resetar formulário
            setTimeout(() => {
                resetarFormularioCandidatura();
                mostrarSecao('dashboard');
            }, 3000);
        }

        function validarLimitesPartido(candidatura) {
            const limite = LIMITES_PARTIDO[candidatura.cargo];
            if (!limite) return true;
            
            let candidatosContados = candidatos.filter(c => 
                c.cargo === candidatura.cargo &&
                c.partidoNumero === candidatura.partidoNumero &&
                c.status !== 'REJEITADO'
            );
            
            if (limite.escopo === 'estado') {
                candidatosContados = candidatosContados.filter(c => c.estadoId === candidatura.estadoId);
            } else if (limite.escopo === 'cidade') {
                candidatosContados = candidatosContados.filter(c => c.cidadeId === candidatura.cidadeId);
            }
            
            return candidatosContados.length < limite.limite;
        }

        function resetarFormularioCandidatura() {
            // Resetar formulário
            document.getElementById('candidatoNome').value = '';
            document.getElementById('candidatoTikTok').value = '';
            document.getElementById('candidatoCargo').value = '';
            document.getElementById('candidatoIdeologia').value = '';
            document.getElementById('candidatoEstado').value = '';
            document.getElementById('candidatoCidade').innerHTML = '<option value="">Selecione uma cidade</option>';
            document.getElementById('candidatoPartido').value = '';
            document.getElementById('candidatoNumero').value = '';
            document.getElementById('candidatoColigacao').value = '';
            document.getElementById('viceNome').value = '';
            document.getElementById('viceTikTok').value = '';
            document.getElementById('viceIdeologia').value = '';
            document.getElementById('vicePartido').value = '';
            document.getElementById('suplenteNome').value = '';
            document.getElementById('suplenteTikTok').value = '';
            document.getElementById('suplenteIdeologia').value = '';
            document.getElementById('suplentePartido').value = '';
            document.getElementById('candidatoDeclaracao').value = '';
            document.getElementById('declaracaoCheck').checked = false;
            document.getElementById('fotoInput').value = '';
            document.getElementById('fotoPreview').style.display = 'none';
            document.getElementById('infoPartido').style.display = 'none';
            
            // Resetar stepper
            document.querySelectorAll('.step').forEach(step => {
                step.classList.remove('active', 'completed');
            });
            document.getElementById('step1').classList.add('active');
            
            // Mostrar etapa 1
            document.querySelectorAll('.form-section').forEach(section => {
                section.style.display = 'none';
            });
            document.getElementById('etapa1').style.display = 'block';
            
            etapaAtual = 1;
        }

        // ============================================
        // PARTIDOS
        // ============================================

        function carregarListaPartidos() {
            const container = document.getElementById('listaPartidos');
            container.innerHTML = '';
            
            for (const ideologia in PARTIDOS_MAP) {
                const section = document.createElement('div');
                section.style.marginBottom = '3rem';
                
                // Converter primeira letra para maiúscula
                const ideologiaNome = ideologia.charAt(0).toUpperCase() + ideologia.slice(1);
                
                section.innerHTML = `
                    <h3 style="color: ${ideologia === 'direita' ? '#0B3C5D' : ideologia === 'centro' ? '#FFD700' : '#CC0000'}; 
                         margin-bottom: 1.5rem; padding-bottom: 0.5rem; border-bottom: 2px solid currentColor;">
                        ${ideologiaNome} <span class="ideologia-tag ideologia-${ideologia}">${PARTIDOS_MAP[ideologia].length} partidos</span>
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem;">
                `;
                
                PARTIDOS_MAP[ideologia].forEach(partido => {
                    section.innerHTML += `
                        <div class="partido-card">
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <div class="partido-numero">${partido.number}</div>
                                <div style="flex: 1;">
                                    <h4 style="color: var(--gold); margin-bottom: 0.5rem;">${partido.name}</h4>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <div style="width: 20px; height: 20px; background: ${partido.color}; border-radius: 4px;"></div>
                                        <span style="color: var(--gold-light); font-size: 0.9rem;">Cor oficial</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                section.innerHTML += '</div>';
                container.appendChild(section);
            }
        }

        function filtrarPartidosExibicao(ideologia) {
            const container = document.getElementById('listaPartidos');
            container.innerHTML = '';
            
            let partidosParaExibir = [];
            
            if (ideologia === 'todos') {
                for (const ideo in PARTIDOS_MAP) {
                    partidosParaExibir = partidosParaExibir.concat(PARTIDOS_MAP[ideo]);
                }
            } else if (PARTIDOS_MAP[ideologia]) {
                partidosParaExibir = PARTIDOS_MAP[ideologia];
            }
            
            if (partidosParaExibir.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 3rem; color: var(--cyber-blue);">
                        <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <p>Nenhum partido encontrado.</p>
                    </div>
                `;
                return;
            }
            
            const section = document.createElement('div');
            section.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem;">
            `;
            
            partidosParaExibir.forEach(partido => {
                section.innerHTML += `
                    <div class="partido-card">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <div class="partido-numero">${partido.number}</div>
                            <div style="flex: 1;">
                                <h4 style="color: var(--gold); margin-bottom: 0.5rem;">${partido.name}</h4>
                                <div style="display: flex; align-items: center; gap: 0.5rem;">
                                    <div style="width: 20px; height: 20px; background: ${partido.color}; border-radius: 4px;"></div>
                                    <span style="color: var(--gold-light); font-size: 0.9rem;">Cor oficial</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            section.innerHTML += '</div>';
            container.appendChild(section);
        }

        // ============================================
        // TRIBUNAL SUPERIOR ELEITORAL - TSE
        // ============================================

        function carregarListaTREs() {
            const container = document.getElementById('listaTREs');
            const totalEstados = document.getElementById('totalEstados');
            const totalCidades = document.getElementById('totalCidades');
            const totalTribunais = document.getElementById('totalTribunais');
            
            totalEstados.textContent = estados.length;
            totalCidades.textContent = cidades.length;
            totalTribunais.textContent = estados.length + cidades.length + 1; // +1 para TSE
            
            container.innerHTML = '';
            
            // TSE Nacional
            container.innerHTML += `
                <div class="form-section">
                    <h3 class="form-section-title">🇧🇷 TSE NACIONAL - BROOKASIL</h3>
                    <div class="info-box">
                        <p><strong>Presidente:</strong> Tutu Protásio</p>
                        <p><strong>Função:</strong> Controle total do sistema eleitoral nacional</p>
                        <p><strong>Poderes:</strong> Único que pode alterar o modo da eleição e controlar o ciclo eleitoral</p>
                        <p><strong>Jurisdição:</strong> Todo o território nacional</p>
                    </div>
                </div>
            `;
            
            // TREs Estaduais
            container.innerHTML += `
                <div class="form-section">
                    <h3 class="form-section-title">🏛️ TREs ESTADUAIS</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem;">
            `;
            
            estados.forEach(estado => {
                const cidadesEstado = cidades.filter(c => c.estadoId === estado.id);
                container.innerHTML += `
                    <div class="partido-card">
                        <h4 style="color: var(--gold); margin-bottom: 1rem;">TRE ${estado.nome}</h4>
                        <p><strong>Presidente:</strong> ${estado.presidente}</p>
                        <p><strong>Jurisdição:</strong> Todo o estado</p>
                        <p><strong>Cargos:</strong> Governador, Senador, Deputados Estaduais</p>
                        <p><strong>Cidades:</strong> ${cidadesEstado.length} municípios</p>
                    </div>
                `;
            });
            
            container.innerHTML += `
                    </div>
                </div>
            `;
            
            // TREs Municipais
            container.innerHTML += `
                <div class="form-section">
                    <h3 class="form-section-title">🏙️ TREs MUNICIPAIS</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1rem;">
            `;
            
            estados.forEach(estado => {
                const cidadesEstado = cidades.filter(c => c.estadoId === estado.id);
                cidadesEstado.forEach(cidade => {
                    container.innerHTML += `
                        <div class="partido-card" style="border-left: 3px solid var(--teal);">
                            <h4 style="color: var(--teal); margin-bottom: 0.5rem;">TRE ${cidade.nome}</h4>
                            <p><strong>Estado:</strong> ${estado.nome}</p>
                            <p><strong>Presidente:</strong> ${cidade.presidente}</p>
                            <p><strong>Jurisdição:</strong> Apenas o município</p>
                            <p><strong>Cargos:</strong> Prefeito e Vereadores</p>
                        </div>
                    `;
                });
            });
            
            container.innerHTML += `
                    </div>
                </div>
            `;
        }

        // ============================================
        // SISTEMA DE LOGIN POR CHAVE
        // ============================================

        function atualizarJurisdicao() {
            const tipoAcesso = document.getElementById('adminType').value;
            const jurisdicaoContainer = document.getElementById('jurisdicaoContainer');
            const jurisdicaoLabel = document.getElementById('jurisdicaoLabel');
            const jurisdicaoSelect = document.getElementById('jurisdicaoSelect');
            
            if (tipoAcesso === 'TSE') {
                jurisdicaoContainer.style.display = 'none';
            } else {
                jurisdicaoContainer.style.display = 'block';
                jurisdicaoSelect.innerHTML = '<option value="">Selecione...</option>';
                
                if (tipoAcesso === 'TRE_ESTADUAL') {
                    jurisdicaoLabel.innerHTML = '<i class="fas fa-map"></i> ESTADO *';
                    estados.forEach(estado => {
                        const option = document.createElement('option');
                        option.value = estado.id;
                        option.textContent = estado.nome;
                        jurisdicaoSelect.appendChild(option);
                    });
                } else if (tipoAcesso === 'TRE_MUNICIPAL') {
                    jurisdicaoLabel.innerHTML = '<i class="fas fa-city"></i> CIDADE *';
                    cidades.forEach(cidade => {
                        const estado = estados.find(e => e.id === cidade.estadoId);
                        const option = document.createElement('option');
                        option.value = cidade.id;
                        option.textContent = `${cidade.nome} - ${estado ? estado.nome : 'N/A'}`;
                        jurisdicaoSelect.appendChild(option);
                    });
                }
            }
        }

        // Função hash simples para demonstração (em produção usar SHA-256)
        function hashKey(key) {
            let hash = 0;
            for (let i = 0; i < key.length; i++) {
                const char = key.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            return hash.toString();
        }

        function realizarLoginAdmin() {
            const tipoAcesso = document.getElementById('adminType').value;
            const jurisdicaoId = document.getElementById('jurisdicaoSelect').value;
            const key = document.getElementById('adminKey').value;
            
            if (!tipoAcesso) {
                mostrarMensagem('login', '❌ Selecione o tipo de acesso!', 'error');
                return;
            }
            
            if (tipoAcesso !== 'TSE' && !jurisdicaoId) {
                mostrarMensagem('login', '❌ Selecione a jurisdição!', 'error');
                return;
            }
            
            if (!key) {
                mostrarMensagem('login', '❌ Digite a chave de acesso!', 'error');
                return;
            }
            
            // Verificar chave (em produção, isso seria feito no backend)
            // Para demonstração, usar chaves fixas
            
            let usuario = null;
            const hashedKey = hashKey(key);
            
            if (tipoAcesso === 'TSE') {
                // Chave do TSE: "BrookasilTSE2024"
                if (hashedKey === hashKey("BrookasilTSE2024")) {
                    usuario = {
                        tipo: 'TSE',
                        nome: 'Tutu Protásio',
                        jurisdicao: 'Nacional',
                        acessoCompleto: true
                    };
                }
            } else if (tipoAcesso === 'TRE_ESTADUAL') {
                const estado = estados.find(e => e.id == jurisdicaoId);
                if (estado) {
                    // Chave genérica para TREs Estaduais: "TRE_" + nome do estado
                    if (hashedKey === hashKey(`TRE_${estado.nome}`)) {
                        usuario = {
                            tipo: 'TRE_ESTADUAL',
                            nome: estado.presidente,
                            jurisdicao: `Estado de ${estado.nome}`,
                            jurisdicaoId: estado.id,
                            acessoCompleto: false
                        };
                    }
                }
            } else if (tipoAcesso === 'TRE_MUNICIPAL') {
                const cidade = cidades.find(c => c.id == jurisdicaoId);
                if (cidade) {
                    const estado = estados.find(e => e.id === cidade.estadoId);
                    // Chave genérica para TREs Municipais: "TRE_" + nome da cidade
                    if (hashedKey === hashKey(`TRE_${cidade.nome}`)) {
                        usuario = {
                            tipo: 'TRE_MUNICIPAL',
                            nome: cidade.presidente,
                            jurisdicao: `Município de ${cidade.nome}`,
                            jurisdicaoId: cidade.id,
                            estadoId: cidade.estadoId,
                            acessoCompleto: false
                        };
                    }
                }
            }
            
            if (usuario) {
                usuarioLogado = usuario;
                localStorage.setItem('tse_usuario_logado', JSON.stringify(usuario));
                
                registrarLog('login', `Login realizado: ${usuario.nome} (${usuario.jurisdicao})`, usuario.nome);
                
                entrarModoAdmin();
                mostrarSecao('admin');
                
                mostrarMensagem('adminInfo', `✅ Login realizado com sucesso! Bem-vindo, ${usuario.nome}!`, 'success');
            } else {
                mostrarMensagem('login', '❌ Chave de acesso incorreta!', 'error');
            }
        }

        function entrarModoAdmin() {
            document.getElementById('adminIndicator').style.display = 'flex';
            document.getElementById('loginSidebar').style.display = 'none';
            document.getElementById('adminSidebar').style.display = 'flex';
            document.getElementById('logsSidebar').style.display = 'flex';
            
            if (usuarioLogado.tipo === 'TSE') {
                document.getElementById('configSidebar').style.display = 'flex';
            }
        }

        function logout() {
            if (usuarioLogado) {
                registrarLog('logout', `Logout realizado: ${usuarioLogado.nome}`, usuarioLogado.nome);
            }
            
            usuarioLogado = null;
            localStorage.removeItem('tse_usuario_logado');
            
            document.getElementById('adminIndicator').style.display = 'none';
            document.getElementById('loginSidebar').style.display = 'flex';
            document.getElementById('adminSidebar').style.display = 'none';
            document.getElementById('logsSidebar').style.display = 'none';
            document.getElementById('configSidebar').style.display = 'none';
            
            mostrarSecao('dashboard');
            mostrarMensagem('dashboard', '✅ Logout realizado com sucesso!', 'success');
        }

        // ============================================
        // PAINEL ADMINISTRATIVO
        // ============================================

        function mostrarDashboardAdmin() {
            const adminInfo = document.getElementById('adminInfo');
            const adminPendentes = document.getElementById('adminPendentes');
            const adminAprovados = document.getElementById('adminAprovados');
            const adminRejeitados = document.getElementById('adminRejeitados');
            const adminTotal = document.getElementById('adminTotal');
            
            // Filtrar candidaturas da jurisdição do usuário
            let candidaturasJurisdicao = [];
            
            if (usuarioLogado.tipo === 'TSE') {
                candidaturasJurisdicao = candidatos;
            } else if (usuarioLogado.tipo === 'TRE_ESTADUAL') {
                candidaturasJurisdicao = candidatos.filter(c => c.estadoId == usuarioLogado.jurisdicaoId);
            } else if (usuarioLogado.tipo === 'TRE_MUNICIPAL') {
                candidaturasJurisdicao = candidatos.filter(c => c.cidadeId == usuarioLogado.jurisdicaoId);
            }
            
            const total = candidaturasJurisdicao.length;
            const pendentes = candidaturasJurisdicao.filter(c => c.status === 'PENDENTE').length;
            const aprovados = candidaturasJurisdicao.filter(c => c.status === 'APROVADO' && c.analisePor === usuarioLogado.nome).length;
            const rejeitados = candidaturasJurisdicao.filter(c => c.status === 'REJEITADO' && c.analisePor === usuarioLogado.nome).length;
            
            adminPendentes.textContent = pendentes;
            adminAprovados.textContent = aprovados;
            adminRejeitados.textContent = rejeitados;
            adminTotal.textContent = total;
            
            adminInfo.innerHTML = `
                <div class="info-box">
                    <h3><i class="fas fa-user-circle"></i> INFORMAÇÕES DO USUÁRIO</h3>
                    <p><strong>Tipo:</strong> ${usuarioLogado.tipo.replace('_', ' ')}</p>
                    <p><strong>Nome:</strong> ${usuarioLogado.nome}</p>
                    <p><strong>Jurisdição:</strong> ${usuarioLogado.jurisdicao}</p>
                    <p><strong>Modo da Eleição:</strong> ${configuracaoSistema.modoEleicao}</p>
                </div>
            `;
            
            // Mostrar candidaturas pendentes
            const adminContent = document.getElementById('adminContent');
            adminContent.innerHTML = '';
            
            if (pendentes > 0) {
                const candidaturasPendentes = candidaturasJurisdicao.filter(c => c.status === 'PENDENTE');
                
                adminContent.innerHTML = `
                    <div style="margin-top: 2rem;">
                        <h3 class="card-title"><i class="fas fa-clock"></i> CANDIDATURAS PENDENTES (${pendentes})</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(400px, 1fr)); gap: 1rem; margin-top: 1.5rem;">
                `;
                
                candidaturasPendentes.slice(0, 6).forEach(candidatura => {
                    const estado = estados.find(e => e.id === candidatura.estadoId);
                    const cidade = cidades.find(c => c.id === candidatura.cidadeId);
                    const partido = encontrarPartidoPorNumero(candidatura.partidoNumero);
                    
                    adminContent.innerHTML += `
                        <div class="partido-card">
                            <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem;">
                                <div>
                                    <h4 style="color: var(--gold); margin-bottom: 0.5rem;">${candidatura.nome}</h4>
                                    <p style="color: var(--cyber-blue); font-size: 0.9rem;">${candidatura.tiktok}</p>
                                </div>
                                <span class="candidate-number">${candidatura.numero}</span>
                            </div>
                            
                            <p><strong>Cargo:</strong> ${candidatura.cargo}</p>
                            <p><strong>Local:</strong> ${cidade ? cidade.nome : 'N/A'} / ${estado ? estado.nome : 'N/A'}</p>
                            <p><strong>Partido:</strong> ${candidatura.partidoNumero} - ${partido ? partido.name.split('(')[0] : 'N/A'}</p>
                            
                            <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                                <button class="btn btn-success" style="flex: 1;" onclick="aprovarCandidatura(${candidatura.id})">
                                    <i class="fas fa-check"></i> Aprovar
                                </button>
                                <button class="btn btn-outline" style="flex: 1;" onclick="mostrarFormRejeitar(${candidatura.id})">
                                    <i class="fas fa-times"></i> Rejeitar
                                </button>
                                <button class="btn btn-outline" onclick="verDetalhesCandidato(${candidatura.id})">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                adminContent.innerHTML += `
                        </div>
                        ${pendentes > 6 ? `<p style="text-align: center; color: var(--cyber-blue); margin-top: 1rem;">... e mais ${pendentes - 6} candidaturas pendentes</p>` : ''}
                    </div>
                `;
            }
        }

        function mostrarCandidaturasPendentes() {
            // Implementação similar à do dashboard admin
            mostrarDashboardAdmin();
        }

        function mostrarCandidaturasAprovadas() {
            // Filtrar candidaturas aprovadas pelo usuário
            let candidaturasAprovadas = [];
            
            if (usuarioLogado.tipo === 'TSE') {
                candidaturasAprovadas = candidatos.filter(c => c.status === 'APROVADO');
            } else {
                candidaturasAprovadas = candidatos.filter(c => 
                    c.status === 'APROVADO' && 
                    c.analisePor === usuarioLogado.nome
                );
            }
            
            const modal = document.getElementById('adminModal');
            const modalTitulo = document.getElementById('modalTitulo');
            const modalContent = document.getElementById('modalContent');
            
            modalTitulo.innerHTML = `<i class="fas fa-check-circle"></i> CANDIDATURAS APROVADAS (${candidaturasAprovadas.length})`;
            
            if (candidaturasAprovadas.length === 0) {
                modalContent.innerHTML = `
                    <div style="text-align: center; padding: 3rem;">
                        <i class="fas fa-check-circle" style="font-size: 3rem; color: var(--success); margin-bottom: 1rem;"></i>
                        <p style="color: var(--cyber-blue);">Nenhuma candidatura aprovada por você.</p>
                    </div>
                `;
            } else {
                modalContent.innerHTML = `
                    <div style="max-height: 400px; overflow-y: auto;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Candidato</th>
                                    <th>Cargo</th>
                                    <th>Local</th>
                                    <th>Partido</th>
                                    <th>Data</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                candidaturasAprovadas.forEach(candidatura => {
                    const estado = estados.find(e => e.id === candidatura.estadoId);
                    const cidade = cidades.find(c => c.id === candidatura.cidadeId);
                    
                    modalContent.innerHTML += `
                        <tr>
                            <td>${candidatura.nome}</td>
                            <td>${candidatura.cargo}</td>
                            <td>${cidade ? cidade.nome : 'N/A'}/${estado ? estado.nome : 'N/A'}</td>
                            <td>${candidatura.partidoNumero}</td>
                            <td>${new Date(candidatura.dataAnalise).toLocaleDateString('pt-BR')}</td>
                        </tr>
                    `;
                });
                
                modalContent.innerHTML += `
                            </tbody>
                        </table>
                    </div>
                `;
            }
            
            modal.classList.add('active');
        }

        function mostrarCandidaturasRejeitadas() {
            // Filtrar candidaturas rejeitadas pelo usuário
            let candidaturasRejeitadas = [];
            
            if (usuarioLogado.tipo === 'TSE') {
                candidaturasRejeitadas = candidatos.filter(c => c.status === 'REJEITADO');
            } else {
                candidaturasRejeitadas = candidatos.filter(c => 
                    c.status === 'REJEITADO' && 
                    c.analisePor === usuarioLogado.nome
                );
            }
            
            const modal = document.getElementById('adminModal');
            const modalTitulo = document.getElementById('modalTitulo');
            const modalContent = document.getElementById('modalContent');
            
            modalTitulo.innerHTML = `<i class="fas fa-times-circle"></i> CANDIDATURAS REJEITADAS (${candidaturasRejeitadas.length})`;
            
            if (candidaturasRejeitadas.length === 0) {
                modalContent.innerHTML = `
                    <div style="text-align: center; padding: 3rem;">
                        <i class="fas fa-times-circle" style="font-size: 3rem; color: var(--danger); margin-bottom: 1rem;"></i>
                        <p style="color: var(--cyber-blue);">Nenhuma candidatura rejeitada por você.</p>
                    </div>
                `;
            } else {
                modalContent.innerHTML = `
                    <div style="max-height: 400px; overflow-y: auto;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Candidato</th>
                                    <th>Cargo</th>
                                    <th>Local</th>
                                    <th>Motivo</th>
                                    <th>Data</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                candidaturasRejeitadas.forEach(candidatura => {
                    const estado = estados.find(e => e.id === candidatura.estadoId);
                    const cidade = cidades.find(c => c.id === candidatura.cidadeId);
                    
                    modalContent.innerHTML += `
                        <tr>
                            <td>${candidatura.nome}</td>
                            <td>${candidatura.cargo}</td>
                            <td>${cidade ? cidade.nome : 'N/A'}/${estado ? estado.nome : 'N/A'}</td>
                            <td>${candidatura.motivoRejeicao || 'Sem motivo registrado'}</td>
                            <td>${new Date(candidatura.dataAnalise).toLocaleDateString('pt-BR')}</td>
                        </tr>
                    `;
                });
                
                modalContent.innerHTML += `
                            </tbody>
                        </table>
                    </div>
                `;
            }
            
            modal.classList.add('active');
        }

        function aprovarCandidatura(candidaturaId) {
            const candidatura = candidatos.find(c => c.id === candidaturaId);
            if (!candidatura) return;
            
            // Verificar permissão
            if (!verificarPermissaoCandidatura(candidatura)) {
                mostrarMensagem('adminInfo', '❌ Esta candidatura não está na sua jurisdição!', 'error');
                return;
            }
            
            candidatura.status = 'APROVADO';
            candidatura.analisePor = usuarioLogado.nome;
            candidatura.dataAnalise = new Date().toISOString();
            
            salvarCandidatos();
            registrarLog('aprovar', `Candidatura aprovada: ${candidatura.nome} (${candidatura.cargo})`, usuarioLogado.nome);
            
            mostrarDashboardAdmin();
            atualizarDashboard();
            mostrarMensagem('adminInfo', `✅ Candidatura de ${candidatura.nome} aprovada com sucesso!`, 'success');
        }

        function mostrarFormRejeitar(candidaturaId) {
            const candidatura = candidatos.find(c => c.id === candidaturaId);
            if (!candidatura) return;
            
            // Verificar permissão
            if (!verificarPermissaoCandidatura(candidatura)) {
                mostrarMensagem('adminInfo', '❌ Esta candidatura não está na sua jurisdição!', 'error');
                return;
            }
            
            const modal = document.getElementById('adminModal');
            const modalTitulo = document.getElementById('modalTitulo');
            const modalContent = document.getElementById('modalContent');
            
            modalTitulo.innerHTML = `<i class="fas fa-times-circle"></i> REJEITAR CANDIDATURA`;
            
            modalContent.innerHTML = `
                <div class="info-box">
                    <p><strong>Candidato:</strong> ${candidatura.nome}</p>
                    <p><strong>Cargo:</strong> ${candidatura.cargo}</p>
                    <p><strong>Partido:</strong> ${candidatura.partidoNumero}</p>
                </div>
                
                <div class="form-group">
                    <label class="form-label"><i class="fas fa-exclamation-triangle"></i> MOTIVO DA REJEIÇÃO *</label>
                    <textarea class="form-textarea" id="motivoRejeicao" rows="4" placeholder="Digite o motivo detalhado da rejeição..." required></textarea>
                    <div class="form-hint">
                        <i class="fas fa-info-circle"></i> O motivo será registrado permanentemente para auditoria
                    </div>
                </div>
                
                <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button class="btn btn-danger" onclick="rejeitarCandidatura(${candidaturaId})">
                        <i class="fas fa-times"></i> CONFIRMAR REJEIÇÃO
                    </button>
                    <button class="btn btn-outline" onclick="fecharModal()">
                        <i class="fas fa-times"></i> CANCELAR
                    </button>
                </div>
            `;
            
            modal.classList.add('active');
        }

        function rejeitarCandidatura(candidaturaId) {
            const motivo = document.getElementById('motivoRejeicao').value.trim();
            if (!motivo) {
                mostrarMensagem('modalContent', '❌ Digite o motivo da rejeição!', 'error');
                return;
            }
            
            const candidatura = candidatos.find(c => c.id === candidaturaId);
            if (!candidatura) return;
            
            // Verificar permissão
            if (!verificarPermissaoCandidatura(candidatura)) {
                mostrarMensagem('adminInfo', '❌ Esta candidatura não está na sua jurisdição!', 'error');
                return;
            }
            
            candidatura.status = 'REJEITADO';
            candidatura.motivoRejeicao = motivo;
            candidatura.analisePor = usuarioLogado.nome;
            candidatura.dataAnalise = new Date().toISOString();
            
            salvarCandidatos();
            registrarLog('rejeitar', `Candidatura rejeitada: ${candidatura.nome} (${candidatura.cargo}) - Motivo: ${motivo}`, usuarioLogado.nome);
            
            fecharModal();
            mostrarDashboardAdmin();
            atualizarDashboard();
            mostrarMensagem('adminInfo', `❌ Candidatura de ${candidatura.nome} rejeitada.`, 'error');
        }

        function verificarPermissaoCandidatura(candidatura) {
            if (usuarioLogado.tipo === 'TSE') return true;
            
            if (usuarioLogado.tipo === 'TRE_ESTADUAL') {
                return candidatura.estadoId == usuarioLogado.jurisdicaoId;
            } else if (usuarioLogado.tipo === 'TRE_MUNICIPAL') {
                return candidatura.cidadeId == usuarioLogado.jurisdicaoId;
            }
            
            return false;
        }

        function verDetalhesCandidato(candidaturaId) {
            const candidatura = candidatos.find(c => c.id === candidaturaId);
            if (!candidatura) return;
            
            const estado = estados.find(e => e.id === candidatura.estadoId);
            const cidade = cidades.find(c => c.id === candidatura.cidadeId);
            const partido = encontrarPartidoPorNumero(candidatura.partidoNumero);
            
            const modal = document.getElementById('adminModal');
            const modalTitulo = document.getElementById('modalTitulo');
            const modalContent = document.getElementById('modalContent');
            
            modalTitulo.innerHTML = `<i class="fas fa-user"></i> DETALHES DA CANDIDATURA`;
            
            let html = `
                <div class="info-box">
                    <h4 style="color: var(--gold); margin-bottom: 1rem;">${candidatura.nome}</h4>
                    <p><strong>TikTok:</strong> ${candidatura.tiktok}</p>
                    <p><strong>Número:</strong> <span class="candidate-number">${candidatura.numero}</span></p>
                    <p><strong>Cargo:</strong> ${candidatura.cargo}</p>
                    <p><strong>Local:</strong> ${cidade ? cidade.nome : 'N/A'} / ${estado ? estado.nome : 'N/A'}</p>
                    <p><strong>Partido:</strong> ${candidatura.partidoNumero} - ${partido ? partido.name : 'N/A'}</p>
                    <p><strong>Ideologia:</strong> <span class="ideologia-tag ideologia-${candidatura.ideologia}">${candidatura.ideologia}</span></p>
                    <p><strong>Status:</strong> <span class="status-badge status-${candidatura.status.toLowerCase()}">${candidatura.status}</span></p>
                    <p><strong>Data de Cadastro:</strong> ${new Date(candidatura.dataCadastro).toLocaleDateString('pt-BR')}</p>
                </div>
                
                <div class="form-section">
                    <h4 class="form-section-title">DECLARAÇÃO DO CANDIDATO</h4>
                    <p>${candidatura.declaracao || 'Sem declaração'}</p>
                </div>
            `;
            
            if (candidatura.vice) {
                const vicePartido = encontrarPartidoPorNumero(candidatura.vice.partidoNumero);
                html += `
                    <div class="form-section">
                        <h4 class="form-section-title">VICE-PRESIDENTE / VICE-GOVERNADOR / VICE-PREFEITO</h4>
                        <div class="info-box">
                            <p><strong>Nome:</strong> ${candidatura.vice.nome}</p>
                            <p><strong>TikTok:</strong> ${candidatura.vice.tiktok}</p>
                            <p><strong>Ideologia:</strong> <span class="ideologia-tag ideologia-${candidatura.vice.ideologia}">${candidatura.vice.ideologia}</span></p>
                            <p><strong>Partido:</strong> ${candidatura.vice.partidoNumero} - ${vicePartido ? vicePartido.name : 'N/A'}</p>
                        </div>
                    </div>
                `;
            }
            
            if (candidatura.suplente) {
                const suplentePartido = encontrarPartidoPorNumero(candidatura.suplente.partidoNumero);
                html += `
                    <div class="form-section">
                        <h4 class="form-section-title">SUPLENTE</h4>
                        <div class="info-box">
                            <p><strong>Nome:</strong> ${candidatura.suplente.nome}</p>
                            <p><strong>TikTok:</strong> ${candidatura.suplente.tiktok}</p>
                            <p><strong>Ideologia:</strong> <span class="ideologia-tag ideologia-${candidatura.suplente.ideologia}">${candidatura.suplente.ideologia}</span></p>
                            <p><strong>Partido:</strong> ${candidatura.suplente.partidoNumero} - ${suplentePartido ? suplentePartido.name : 'N/A'}</p>
                        </div>
                    </div>
                `;
            }
            
            if (candidatura.analisePor) {
                html += `
                    <div class="form-section">
                        <h4 class="form-section-title">ANÁLISE</h4>
                        <div class="info-box">
                            <p><strong>Analisado por:</strong> ${candidatura.analisePor}</p>
                            <p><strong>Data da Análise:</strong> ${new Date(candidatura.dataAnalise).toLocaleDateString('pt-BR')}</p>
                            ${candidatura.motivoRejeicao ? `<p><strong>Motivo da Rejeição:</strong> ${candidatura.motivoRejeicao}</p>` : ''}
                        </div>
                    </div>
                `;
            }
            
            modalContent.innerHTML = html;
            modal.classList.add('active');
        }

        function fecharModal() {
            document.getElementById('adminModal').classList.remove('active');
        }

        // ============================================
        // CONFIGURAÇÕES DO SISTEMA (APENAS TSE)
        // ============================================

        function carregarConfiguracao() {
            const statusModoEleicao = document.getElementById('statusModoEleicao');
            const statusCiclo = document.getElementById('statusCiclo');
            const ultimaAlteracao = document.getElementById('ultimaAlteracao');
            
            statusModoEleicao.textContent = configuracaoSistema.modoEleicao;
            statusModoEleicao.className = `status-badge status-${configuracaoSistema.modoEleicao === 'MUNICIPAL' ? 'pendente' : 'aprovado'}`;
            
            // Traduzir status do ciclo
            let statusCicloTexto = '';
            switch(configuracaoSistema.statusCiclo) {
                case 'candidaturas_abertas':
                    statusCicloTexto = 'CANDIDATURAS ABERTAS';
                    break;
                case 'candidaturas_fechadas':
                    statusCicloTexto = 'CANDIDATURAS FECHADAS';
                    break;
                case 'votacao_aberta':
                    statusCicloTexto = 'VOTAÇÃO ABERTA';
                    break;
                case 'votacao_encerrada':
                    statusCicloTexto = 'VOTAÇÃO ENCERRADA';
                    break;
                default:
                    statusCicloTexto = configuracaoSistema.statusCiclo;
            }
            
            statusCiclo.textContent = statusCicloTexto;
            statusCiclo.className = `status-badge status-${configuracaoSistema.statusCiclo.includes('aberta') ? 'aprovado' : 'rejeitado'}`;
            
            ultimaAlteracao.textContent = configuracaoSistema.ultimaAlteracao ? 
                new Date(configuracaoSistema.ultimaAlteracao).toLocaleString('pt-BR') : 
                'Nenhuma alteração registrada';
        }

        function atualizarInterfaceConfiguracao() {
            document.getElementById('configModoEleicao').value = configuracaoSistema.modoEleicao;
            carregarConfiguracao();
        }

        function alterarStatusCiclo(novoStatus) {
            if (!usuarioLogado || usuarioLogado.tipo !== 'TSE') {
                mostrarMensagem('configMessage', '❌ Apenas o TSE Nacional pode alterar o ciclo eleitoral!', 'error');
                return;
            }
            
            configuracaoSistema.statusCiclo = novoStatus;
            configuracaoSistema.ultimaAlteracao = new Date().toISOString();
            
            salvarConfiguracao();
            carregarConfiguracao();
            
            registrarLog('config', `Ciclo eleitoral alterado para: ${novoStatus}`, usuarioLogado.nome);
            
            mostrarMensagem('configMessage', '✅ Status do ciclo eleitoral atualizado com sucesso!', 'success');
        }

        function adicionarEstado() {
            if (!usuarioLogado || usuarioLogado.tipo !== 'TSE') {
                mostrarMensagem('configMessage', '❌ Apenas o TSE Nacional pode adicionar estados!', 'error');
                return;
            }
            
            const nomeEstado = document.getElementById('novoEstado').value.trim();
            if (!nomeEstado) {
                mostrarMensagem('configMessage', '❌ Digite o nome do estado!', 'error');
                return;
            }
            
            // Verificar se estado já existe
            if (estados.some(e => e.nome.toLowerCase() === nomeEstado.toLowerCase())) {
                mostrarMensagem('configMessage', '❌ Este estado já está cadastrado!', 'error');
                return;
            }
            
            const novoEstado = {
                id: Date.now(),
                nome: nomeEstado,
                presidente: `Presidente do TRE ${nomeEstado}`
            };
            
            estados.push(novoEstado);
            salvarEstados();
            inicializarSelects();
            
            // Adicionar 3 cidades padrão
            for (let i = 1; i <= 3; i++) {
                const novaCidade = {
                    id: Date.now() + i,
                    nome: `${nomeEstado} Cidade ${i}`,
                    estadoId: novoEstado.id,
                    presidente: `Presidente do TRE ${nomeEstado} Cidade ${i}`
                };
                cidades.push(novaCidade);
            }
            salvarCidades();
            
            registrarLog('sistema', `Novo estado adicionado: ${nomeEstado}`, usuarioLogado.nome);
            
            mostrarMensagem('configMessage', `✅ Estado ${nomeEstado} adicionado com 3 cidades padrão!`, 'success');
            document.getElementById('novoEstado').value = '';
        }

        function adicionarCidade() {
            if (!usuarioLogado || usuarioLogado.tipo !== 'TSE') {
                mostrarMensagem('configMessage', '❌ Apenas o TSE Nacional pode adicionar cidades!', 'error');
                return;
            }
            
            const estadoId = document.getElementById('estadoParaCidade').value;
            const nomeCidade = document.getElementById('novaCidade').value.trim();
            
            if (!estadoId || !nomeCidade) {
                mostrarMensagem('configMessage', '❌ Selecione o estado e digite o nome da cidade!', 'error');
                return;
            }
            
            const estado = estados.find(e => e.id == estadoId);
            if (!estado) {
                mostrarMensagem('configMessage', '❌ Estado não encontrado!', 'error');
                return;
            }
            
            // Verificar se cidade já existe no estado
            if (cidades.some(c => c.estadoId == estadoId && c.nome.toLowerCase() === nomeCidade.toLowerCase())) {
                mostrarMensagem('configMessage', '❌ Esta cidade já está cadastrada neste estado!', 'error');
                return;
            }
            
            const novaCidade = {
                id: Date.now(),
                nome: nomeCidade,
                estadoId: parseInt(estadoId),
                presidente: `Presidente do TRE ${nomeCidade}`
            };
            
            cidades.push(novaCidade);
            salvarCidades();
            inicializarSelects();
            
            registrarLog('sistema', `Nova cidade adicionada: ${nomeCidade} (${estado.nome})`, usuarioLogado.nome);
            
            mostrarMensagem('configMessage', `✅ Cidade ${nomeCidade} adicionada ao estado ${estado.nome}!`, 'success');
            document.getElementById('novaCidade').value = '';
        }

        // ============================================
        // LOGS DO SISTEMA
        // ============================================

        function carregarLogs() {
            const tbody = document.getElementById('logsTable');
            const totalLogs = document.getElementById('totalLogs');
            
            tbody.innerHTML = '';
            totalLogs.textContent = logs.length;
            
            if (logs.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 3rem; color: var(--cyber-blue);">
                            <i class="fas fa-history" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                            <p>Nenhum log registrado no momento.</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Ordenar logs por data (mais recente primeiro)
            const logsOrdenados = [...logs].sort((a, b) => 
                new Date(b.timestamp) - new Date(a.timestamp)
            );
            
            logsOrdenados.forEach(log => {
                const data = new Date(log.timestamp);
                const dataFormatada = data.toLocaleDateString('pt-BR') + ' ' + data.toLocaleTimeString('pt-BR');
                
                // Determinar ícone e cor baseado no tipo
                let icon = 'fa-info-circle';
                let color = 'var(--cyber-blue)';
                
                switch(log.tipo) {
                    case 'aprovar':
                        icon = 'fa-check-circle';
                        color = 'var(--success)';
                        break;
                    case 'rejeitar':
                        icon = 'fa-times-circle';
                        color = 'var(--danger)';
                        break;
                    case 'login':
                        icon = 'fa-sign-in-alt';
                        color = 'var(--gold)';
                        break;
                    case 'logout':
                        icon = 'fa-sign-out-alt';
                        color = 'var(--warning)';
                        break;
                    case 'candidatura':
                        icon = 'fa-user-plus';
                        color = 'var(--teal)';
                        break;
                }
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${dataFormatada}</td>
                    <td>${log.usuario || 'Sistema'}</td>
                    <td><i class="fas ${icon}" style="color: ${color};"></i> ${log.tipo}</td>
                    <td>${log.acao}</td>
                    <td>${log.detalhes || ''}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function filtrarLogs() {
            const tipo = document.getElementById('filterLogTipo').value;
            const usuario = document.getElementById('filterLogUsuario').value.toLowerCase();
            const dataInicio = document.getElementById('filterLogDataInicio').value;
            const dataFim = document.getElementById('filterLogDataFim').value;
            
            let logsFiltrados = [...logs];
            
            // Aplicar filtros
            if (tipo) {
                logsFiltrados = logsFiltrados.filter(log => log.tipo === tipo);
            }
            
            if (usuario) {
                logsFiltrados = logsFiltrados.filter(log => 
                    (log.usuario || '').toLowerCase().includes(usuario)
                );
            }
            
            if (dataInicio) {
                const inicio = new Date(dataInicio);
                logsFiltrados = logsFiltrados.filter(log => 
                    new Date(log.timestamp) >= inicio
                );
            }
            
            if (dataFim) {
                const fim = new Date(dataFim);
                fim.setHours(23, 59, 59, 999);
                logsFiltrados = logsFiltrados.filter(log => 
                    new Date(log.timestamp) <= fim
                );
            }
            
            const tbody = document.getElementById('logsTable');
            const totalLogs = document.getElementById('totalLogs');
            
            tbody.innerHTML = '';
            totalLogs.textContent = logsFiltrados.length;
            
            if (logsFiltrados.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 3rem; color: var(--cyber-blue);">
                            <i class="fas fa-search" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                            <p>Nenhum log encontrado com os filtros aplicados.</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Ordenar por data
            logsFiltrados.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            logsFiltrados.forEach(log => {
                const data = new Date(log.timestamp);
                const dataFormatada = data.toLocaleDateString('pt-BR') + ' ' + data.toLocaleTimeString('pt-BR');
                
                let icon = 'fa-info-circle';
                let color = 'var(--cyber-blue)';
                
                switch(log.tipo) {
                    case 'aprovar':
                        icon = 'fa-check-circle';
                        color = 'var(--success)';
                        break;
                    case 'rejeitar':
                        icon = 'fa-times-circle';
                        color = 'var(--danger)';
                        break;
                    case 'login':
                        icon = 'fa-sign-in-alt';
                        color = 'var(--gold)';
                        break;
                    case 'logout':
                        icon = 'fa-sign-out-alt';
                        color = 'var(--warning)';
                        break;
                    case 'candidatura':
                        icon = 'fa-user-plus';
                        color = 'var(--teal)';
                        break;
                }
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${dataFormatada}</td>
                    <td>${log.usuario || 'Sistema'}</td>
                    <td><i class="fas ${icon}" style="color: ${color};"></i> ${log.tipo}</td>
                    <td>${log.acao}</td>
                    <td>${log.detalhes || ''}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function resetarFiltrosLogs() {
            document.getElementById('filterLogTipo').value = '';
            document.getElementById('filterLogUsuario').value = '';
            document.getElementById('filterLogDataInicio').value = '';
            document.getElementById('filterLogDataFim').value = '';
            carregarLogs();
        }

        function exportarLogs() {
            const logsStr = JSON.stringify(logs, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(logsStr);
            
            const link = document.createElement('a');
            link.setAttribute('href', dataUri);
            link.setAttribute('download', `logs_tse_${new Date().toISOString().split('T')[0]}.json`);
            link.click();
            
            mostrarMensagem('logs', '✅ Logs exportados com sucesso!', 'success');
        }

        function limparLogsAntigos() {
            if (!confirm('⚠️ Esta ação irá apagar todos os logs antigos (anteriores a 30 dias).\n\nDeseja continuar?')) {
                return;
            }
            
            const trintaDiasAtras = new Date();
            trintaDiasAtras.setDate(trintaDiasAtras.getDate() - 30);
            
            const logsAntigos = logs.filter(log => new Date(log.timestamp) < trintaDiasAtras);
            
            if (logsAntigos.length === 0) {
                mostrarMensagem('logs', 'ℹ️ Não há logs antigos para limpar.', 'warning');
                return;
            }
            
            // Manter apenas logs dos últimos 30 dias
            logs = logs.filter(log => new Date(log.timestamp) >= trintaDiasAtras);
            salvarLogs();
            
            registrarLog('sistema', `${logsAntigos.length} logs antigos foram apagados`, usuarioLogado?.nome || 'Sistema');
            
            carregarLogs();
            mostrarMensagem('logs', `✅ ${logsAntigos.length} logs antigos foram apagados!`, 'success');
        }

        function registrarLog(tipo, acao, usuario = null, detalhes = null) {
            const log = {
                id: Date.now(),
                timestamp: new Date().toISOString(),
                tipo: tipo,
                usuario: usuario,
                acao: acao,
                detalhes: detalhes
            };
            
            logs.push(log);
            salvarLogs();
            
            // Atualizar logs se a seção estiver ativa
            if (document.getElementById('logs')?.classList.contains('active')) {
                carregarLogs();
            }
        }

        // ============================================
        // FUNÇÕES AUXILIARES
        // ============================================

        function encontrarPartidoPorNumero(numero) {
            for (const ideologia in PARTIDOS_MAP) {
                const partido = PARTIDOS_MAP[ideologia].find(p => p.number === numero);
                if (partido) return partido;
            }
            return null;
        }

        function mostrarMensagem(elementId, mensagem, tipo) {
            const element = document.getElementById(elementId);
            if (!element) return;
            
            element.innerHTML = `
                <div class="message message-${tipo === 'success' ? 'success' : tipo === 'error' ? 'error' : 'warning'}">
                    ${mensagem}
                </div>
            `;
            element.style.display = 'block';
            
            if (tipo === 'success') {
                setTimeout(() => {
                    element.style.display = 'none';
                }, 5000);
            }
        }

        // ============================================
        // INICIALIZAÇÃO FINAL
        // ============================================

        // Ajustar altura do main content
        function ajustarAlturaMainContent() {
            const headerHeight = document.querySelector('.header').offsetHeight;
            document.querySelector('.main-content').style.marginTop = headerHeight + 20 + 'px';
        }

        window.addEventListener('resize', ajustarAlturaMainContent);
        window.addEventListener('load', ajustarAlturaMainContent);
        ajustarAlturaMainContent();
    </script>
</body>
</html>
